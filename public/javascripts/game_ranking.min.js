function str_pad(e){return String("00"+e).slice(-2)}var editing_item=null,search_value=null,page_datatable=null,deleted_obj=null,deleted_id=null,gameName=null;_current_page=1;var Page_script={init:function(){}};_send_info.data={limit:1e3,offset:0};var load_page=function(){function e(e){_send_info.data={id:editing_item,name:$(".txt_add_edit_item_name").val(),serviceId:$("#single_select_game").val(),description:a.html.get(),status:$(".select_status option:selected").val()};var t="";switch(e){case"CREATE":editing_item=null,t="POST";break;case"UPDATE":t="PUT"}$(".loading_icon").show(),$.ajax({url:base_request_url+"/admin/game-ranking",type:t,data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){page_datatable.ajax.reload(null,!1),"01"==e.status?(show_toast_notif("success","Successfully","Updated '"+$(".txt_add_edit_item_name").val()+"'",function(){}),$("#modal_add_edit").modal("hide")):show_toast_notif("error","Fail",e.message,function(){}),$(".loading_icon").hide()},error:function(e){console.log(_send_info.data),show_toast_notif("error","Fail","Error '"+e.responseText+"'",function(){}),$(".loading_icon").hide()}})}var a=new FroalaEditor("textarea#froala-editor");_send_info.data={limit:_per_page,offset:_per_page*(_current_page-1)},$(".bs-select").selectpicker({iconBase:"fa",tickIcon:"fa-check"}),page_datatable=$("#page_datatable").DataTable({ajax:{url:base_request_url+"/admin/game-ranking",type:"GET",data:function(e){null!=search_value&&""!=search_value&&(e.searchValue=search_value),e.limit=_per_page,e.offset=_per_page*(_current_page-1)},contentType:"application/json",dataType:"json",dataSrc:function(e){console.log(e);var a=0;if($(".datatable_paging").html(""),e.totalRecords>_per_page)for(a=1;a<=Math.ceil(e.totalRecords/_per_page);a++)a==_current_page?$(".datatable_paging").append("<span class='datatable_paging_number_active' page="+a+">"+a+"</span>"):1!=a&&a!=Math.ceil(e.totalRecords/_per_page)&&a!=_current_page-1&&a!=_current_page-2&&a!=_current_page+2&&a!=_current_page+1||(1==a&&_current_page>4?($(".datatable_paging").append("<span class='datatable_paging_number' page="+a+">"+a+"</span>"),$($(".datatable_paging_number")[0]).after("<span class='paging_truncate'>...</span>")):a==Math.ceil(e.totalRecords/_per_page)&&_current_page<Math.ceil(e.totalRecords/_per_page)-3?($(".datatable_paging").append("<span class='datatable_paging_number' page="+a+">"+a+"</span>"),$($(".datatable_paging_number")[$(".datatable_paging_number").length-1]).before("<span class='paging_truncate'>...</span>")):$(".datatable_paging").append("<span class='datatable_paging_number' page="+a+">"+a+"</span>"));else $(".datatable_paging").html("<span class='datatable_paging_number_active' page=1>1</span>");return $(".datatable_paging_number").click(function(e){_current_page=parseInt($(e.target).attr("page")),page_datatable.ajax.reload()}),null!=e.data?e.data:[]},beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},error:function(e,a,t){"invalid_token"==JSON.parse(e.responseText).error&&(localStorage.removeItem("user_data"),document.location.replace("login"))}},responsive:!1,columns:[{title:"ID",data:"id"},{title:"Name",data:"name"},{title:"Status",data:null,render:function(e,a,t,n){return e="active"==t.status?"<div class='active_status'> Active </div>":"<div class='inactive_status'> Inactive </div>",e}},{title:"Create On",data:null,render:function(e,a,t,n){var i=moment(t.createOn).format("YYYY-MMMM-D HH:mm");return i}},{title:"Update On",data:null,render:function(e,a,t,n){var i=moment(t.updateOn).format("YYYY-MMMM-D HH:mm");return i}},{title:"Action",data:null,render:function(e,a,t,n){var i="";return i+="<a class='btn_edit_item' item_id='"+t.id+"' item_obj='"+JSON.stringify(t)+"'><i class='icon-wrench'></i> Edit </a>",i+="<a class='btn_delete_item' item_id='"+t.id+"' item_obj='"+JSON.stringify(t)+"'><i class='icon-trash'></i> Delete </a>",i+="<a class='btn_edit_item' href='/game_ranking_rank?game_ranking_id="+t.id+"'><i class='icon-wrench'></i> Quản Lý Rank</a>",i}}],aoColumnDefs:[{responsivePriority:1,sWidth:"5%",aTargets:[0]},{responsivePriority:2,sWidth:"25%",aTargets:[1]},{responsivePriority:3,sWidth:"15%",aTargets:[2]},{responsivePriority:4,sWidth:"15%",aTargets:[3]},{responsivePriority:5,sWidth:"15%",aTargets:[4]},{responsivePriority:6,sWidth:"25%",aTargets:[5]}],autoWidth:!0,lengthChange:!0,info:!1,bSort:!0,bFilter:!1,bPaginate:!1,fnDrawCallback:function(e){$(".btn_edit_item").click(function(){var e=JSON.parse($(this).attr("item_obj"));editing_item=e.id,$(".txt_add_edit_item_name").val(e.name),$("#single_select_game").val(e.serviceId),a.html.set(e.description),$(".select_status option").filter(function(){return $.trim($(this).val())==e.status}).prop("selected",!0),$(".select_status").selectpicker("refresh"),"active"==e.status?$(".select_status button").css("background-color","#32c5d2"):$(".select_status button").css("background-color","red"),$(".rank_clone").remove(),$("#modal_add_edit .btn_modal_save_new").hide(),$("#modal_add_edit .btn_modal_save_update").show(),$("#modal_add_edit").modal("show"),null!=e.gameRankingRanks&&($.each(e.gameRankingRanks,function(e,a){$(".rank_detail").children(".rank_name").html("");var t=$(".rank_detail").clone();t.removeClass("rank_detail"),t.addClass("rank_clone"),t.children(".rank_name").html(a.rankName),t.children(".rank_item_name").html(a.gameRankingItems[0].itemName),t.children(".rank_item_quantity").html(a.gameRankingItems[0].itemQuantity),$(".item_group").append(t),null!=a.gameRankingItems&&$.each(a.gameRankingItems,function(e,t){if(0!=e){var n=$(".rank_detail").clone();n.removeClass("rank_detail"),n.addClass("rank_clone"),n.children(".rank_item_name").html(t.itemName),n.children(".rank_item_quantity").html(t.itemQuantity),$(".item_group").append(n),e==a.gameRankingItems.length-1&&$(".item_group").append("<hr class= 'rank_clone'>")}})}),$(".rank_detail").hide(),$(".rank_clone").show()),$(".btn_rank_manager").attr("href","/game_ranking_rank?game_ranking_id="+e.id)}),$(".btn_delete_item").click(function(){var e=JSON.parse($(this).attr("item_obj"));deleted_obj=e,deleted_id=e.id,$("#modal_confirm").modal("show")})}}),$(".select_status").change(function(){""!=$(this).val()&&("active"==$(this).val()?$(".select_status button").css("background-color","#32c5d2"):"inactive"==$(this).val()&&$(".select_status button").css("background-color","red"),$(".hidden_item_status").val($(this).val()))}),$(".btn_add_new_item").click(function(){$("#add_edit_game_ranking_form").trigger("reset"),$(".rank_clone").remove(),a=new FroalaEditor("textarea#froala-editor"),$("#modal_add_edit .btn_modal_save_new").show(),$("#modal_add_edit .btn_modal_save_update").hide(),$("#modal_add_edit").modal("show"),$("#modal_add_edit .btn_modal_save_new").click(function(){e("CREATE")})}),$("#modal_add_edit .btn_modal_save_update").click(function(){e("UPDATE")}),$(".btn_confirm_yes").click(function(){$.ajax({url:base_request_url+"/admin/game-ranking?id="+deleted_id,type:"DELETE",contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(){$("#modal_confirm").modal("hide"),_send_info.data={},page_datatable.ajax.reload(),$("#modal_add_edit").modal("hide"),show_toast_notif("success","Successfully","Deleted: '"+deleted_obj.name+"'",function(){})},error:function(e){show_toast_notif("error","Error","'"+e.responseText+"'",function(){})}})}),$("#single_select_game").change(function(){var e=$("#single_select_game").val();0!=e?$(".txt_add_edit_service_id").attr("disabled","disable"):$(".txt_add_edit_service_id").removeAttr("disabled"),console.log(e),$(".txt_add_edit_service_id").val(e)}),$.ajax({url:base_request_url+"/admin/splayGame",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){$(e.data).each(function(e,a){$("#single_select_game").append("<option value='"+a.scoinGameId+"'> "+a.name+"</option>")})},error:function(e){console.log(e.error())}})};jQuery(document).ready(function(){Page_script.init(),load_page()});