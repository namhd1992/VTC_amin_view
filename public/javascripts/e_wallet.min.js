var Page_script=function(){return{init:function(){}}}(),getDataByKeyName=function(t,e){var a=null;return $(t).each(function(t,n){e==n.keyName&&(a=n)}),a},getDataFromTable=function(t){var e=[],a=$("."+t+" .data_row");return $.each(a,function(t,a){var n={},r=$(a).find("td");$.each(r,function(t,e){if(""!=e.className){var a=e.className.split("data_cell_")[1];n[a]=$(e).html()}}),e.push(n)}),e},compare_transfer_item=function(t,e){return parseInt(t.from)<parseInt(e.from)?-1:parseInt(t.from)>parseInt(e.from)?1:0},compare_deposit_item=function(t,e){return parseInt(t.scoin)<parseInt(e.scoin)?-1:parseInt(t.scoin)>parseInt(e.scoin)?1:0},reload_form=function(){$.ajax({url:base_request_url+"/admin/walletConfig",type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(t){if("Success"==t.onlyMessage){console.log(t),"enabled"==getDataByKeyName(t.dataArr,"deposit").value?($($(".cb_deposit").parent()[0]).addClass("checked"),$(".cb_deposit").attr("checked","checked"),$(".cb_deposit_text").html("Enabled"),$(".cb_deposit").parent().parent().parent()[0].className="lb_cb_active"):"disabled"==getDataByKeyName(t.dataArr,"deposit").value&&($($(".cb_deposit").parent()[0]).removeClass("checked"),$(".cb_deposit").attr("checked",""),$(".cb_deposit_text").html("Disabled"),$(".cb_deposit").parent().parent().parent()[0].className="lb_cb_deactive"),"enabled"==getDataByKeyName(t.dataArr,"money transfer").value?($($(".cb_transfer").parent()[0]).addClass("checked"),$(".cb_transfer").attr("checked","checked"),$(".cb_transfer_text").html("Enabled"),$(".cb_transfer").parent().parent().parent()[0].className="lb_cb_active"):"disabled"==getDataByKeyName(t.dataArr,"money transfer").value&&($($(".cb_transfer").parent()[0]).removeClass("checked"),$(".cb_transfer").attr("checked",""),$(".cb_transfer_text").html("Disabled"),$(".cb_transfer").parent().parent().parent()[0].className="lb_cb_deactive"),$(".txt_max_transfer_day").val(getDataByKeyName(t.dataArr,"max transaction transfer per day").value),$(".txt_max_coin_day").val(getDataByKeyName(t.dataArr,"max balance transfer per day").value),$(".txt_max_coin_time").val(getDataByKeyName(t.dataArr,"max balance transfer per transaction").value),$(".txt_max_fail_day").val(getDataByKeyName(t.dataArr,"max fail transfer per day").value),$(".txt_time_between").val(getDataByKeyName(t.dataArr,"time between two transaction").value),$(".data_row").remove();var e=JSON.parse(getDataByKeyName(t.dataArr,"transfer fee").value);$.each(e,function(t,e){$(".table_transfer_fee .input_row").before("<tr class='data_row'><td class='data_cell_from'>"+e.from+"</td><td class='data_cell_to'>"+e.to+"</td><td class='data_cell_feePercent'>"+e.feePercent+"</td><td class='data_cell_minFee'>"+e.minFee+"</td><td><div class='btn btn-link btn_transfer_fee_remove'>Remove</div><div class='btn btn-link btn_transfer_fee_edit'>Edit</div><div class='btn btn-link btn_transfer_fee_update' style='display:none;'>Save</div></td></tr>"),$(".table_transfer_fee .input_row").prev().find(".btn_transfer_fee_remove").click(function(){$(this).parent().parent().remove()}),$(".table_transfer_fee .input_row").prev().find(".btn_transfer_fee_edit").click(function(){var t=$(this).parent().parent().find("td");$.each(t,function(t,e){if(""!=e.className){var a=$(e).html();$(e).html("<input type='number' value='"+a+"' />")}}),$(this).parent().find(".btn_transfer_fee_update").show(),$(this).hide()}),$(".table_transfer_fee .input_row").prev().find(".btn_transfer_fee_update").click(function(){var t=$($(this).parent().parent().find("td.data_cell_from input")[0]).val(),e=$($(this).parent().parent().find("td.data_cell_to input")[0]).val();if(t>e)return void show_toast_notif("error","Error","'From' value cant bigger than 'to' value",function(){});var a=$(this).parent().parent().find("td");$.each(a,function(t,e){if(""!=e.className){var a=$($(e).find("input")[0]).val();$(e).html(a)}}),$(this).parent().find(".btn_transfer_fee_edit").show(),$(this).hide()})});var a=JSON.parse(getDataByKeyName(t.dataArr,"deposit setting").value);$.each(a,function(t,e){$(".table_deposit .input_row").before("<tr class='data_row'><td class='data_cell_scoin'>"+e.scoin+"</td><td class='data_cell_leagueBalance'>"+e.leagueBalance+"</td><td><div class='btn btn-link btn_deposit_remove'>remove</div><div class='btn btn-link btn_deposit_edit'>Edit</div><div class='btn btn-link btn_deposit_update' style='display:none;'>Save</div></td></tr>"),$(".table_deposit .input_row").prev().find(".btn_deposit_remove").click(function(){$(this).parent().parent().remove()}),$(".table_deposit .input_row").prev().find(".btn_deposit_edit").click(function(){var t=$(this).parent().parent().find("td");$.each(t,function(t,e){if(""!=e.className){var a=$(e).html();$(e).html("<input type='number' value='"+a+"' />")}}),$(this).parent().find(".btn_deposit_update").show(),$(this).hide()}),$(".table_deposit .input_row").prev().find(".btn_deposit_update").click(function(){var t=$(this).parent().parent().find("td");$.each(t,function(t,e){if(""!=e.className){var a=$($(e).find("input")[0]).val();$(e).html(a)}}),$(this).parent().find(".btn_deposit_edit").show(),$(this).hide()})})}else show_toast_notif("error","Error","Fail to load wallet config informations",function(){})},error:function(t){show_toast_notif("error","Error","Error message '"+t.responseText+"'",function(){})}})},load_page=function(){reload_form(),$(":checkbox").on("click",function(){$(this).parent().nextAll("select").prop("disabled",!this.checked),console.log(this),"cb_deposit"==$(this).attr("class")&&("checked"==$(this).parent().attr("class")?($(this).parent().parent().parent()[0].className="lb_cb_active",$($(this).parent().parent().parent()[0]).find(".cb_deposit_text").html("Enabled")):($(this).parent().parent().parent()[0].className="lb_cb_deactive",$($(this).parent().parent().parent()[0]).find(".cb_deposit_text").html("Disabled"))),"cb_transfer"==$(this).attr("class")&&("checked"==$(this).parent().attr("class")?($(this).parent().parent().parent()[0].className="lb_cb_active",$($(this).parent().parent().parent()[0]).find(".cb_transfer_text").html("Enabled")):($(this).parent().parent().parent()[0].className="lb_cb_deactive",$($(this).parent().parent().parent()[0]).find(".cb_transfer_text").html("Disabled")))}),$(".btn_transfer_add").on("click",function(){var t=$($(".txt_transfer_fee_from")[0]).val(),e=$($(".txt_transfer_fee_to")[0]).val(),a=$($(".txt_transfer_fee_percent")[0]).val(),n=$($(".txt_transfer_fee_min")[0]).val();return t>e?void show_toast_notif("error","Error","'From' value cant bigger than 'to' value",function(){}):($(".table_transfer_fee .input_row").before("<tr class='data_row'><td class='data_cell_from'>"+t+"</td><td class='data_cell_to'>"+e+"</td><td class='data_cell_feePercent'>"+a+"</td><td class='data_cell_minFee'>"+n+"</td><td><div class='btn btn-link btn_transfer_fee_remove'>remove</div><div class='btn btn-link btn_transfer_fee_edit'>Edit</div><div class='btn btn-link btn_transfer_fee_update' style='display:none;'>Save</div></td></tr>"),$(".table_transfer_fee .input_row").prev().find(".btn_transfer_fee_remove").click(function(){$(this).parent().parent().remove()}),$(".table_transfer_fee .input_row").prev().find(".btn_transfer_fee_edit").click(function(){var t=$(this).parent().parent().find("td");$.each(t,function(t,e){if(""!=e.className){var a=$(e).html();$(e).html("<input type='number' value='"+a+"' />")}}),$(this).parent().find(".btn_transfer_fee_update").show(),$(this).hide()}),$(".table_transfer_fee .input_row").prev().find(".btn_transfer_fee_update").click(function(){var t=$(this).parent().parent().find("td"),e=$($(this).parent().parent().find("td.data_cell_from")[0]).val(),a=$($(this).parent().parent().find("td.data_cell_to")[0]).val();return console.log(e+"-"+a),e>a?void show_toast_notif("error","Error","'From' value cant bigger than 'to' value",function(){}):($.each(t,function(t,e){if(""!=e.className){var a=$($(e).find("input")[0]).val();$(e).html(a)}}),$(this).parent().find(".btn_transfer_fee_edit").show(),void $(this).hide())}),$($(".txt_transfer_fee_from")[0]).val(0),$($(".txt_transfer_fee_to")[0]).val(0),$($(".txt_transfer_fee_percent")[0]).val(0),void $($(".txt_transfer_fee_min")[0]).val(0))}),$(".btn_deposit_add").on("click",function(){var t=parseInt($($(".txt_deposit_coin")[0]).val()),e=parseInt($($(".txt_deposit_price")[0]).val()),a=!1;$(".data_cell_leagueBalance").each(function(t,n){parseInt($(n).html())==e&&(show_toast_notif("error","Error","League Point value is already exist",function(){}),a=!0)}),$(".data_cell_scoin").each(function(e,n){parseInt($(n).html())==t&&(show_toast_notif("error","Error","S-Coin value is already exist",function(){}),a=!0)}),a||($(".table_deposit .input_row").before("<tr class='data_row'><td class='data_cell_leagueBalance'>"+t+"</td><td class='data_cell_scoin'>"+e+"</td><td><div class='btn btn-link btn_deposit_remove'>remove</div><div class='btn btn-link btn_deposit_edit'>Edit</div><div class='btn btn-link btn_deposit_update' style='display:none;'>Save</div></td></tr>"),$(".table_deposit .input_row").prev().find(".btn_deposit_remove").click(function(){$(this).parent().parent().remove()}),$(".table_deposit .input_row").prev().find(".btn_deposit_edit").click(function(){var t=$(this).parent().parent().find("td");$.each(t,function(t,e){if(""!=e.className){var a=$(e).html();$(e).html("<input type='number' value='"+a+"' />")}}),$(this).parent().find(".btn_deposit_update").show(),$(this).hide()}),$(".table_deposit .input_row").prev().find(".btn_deposit_update").click(function(){var t=$(this).parent().parent().find("td");$.each(t,function(t,e){if(""!=e.className){var a=$($(e).find("input")[0]).val();$(e).html(a)}}),$(this).parent().find(".btn_deposit_edit").show(),$(this).hide()}),$($(".txt_deposit_coin")[0]).val(0),$($(".txt_deposit_price")[0]).val(0))}),$(".btn_save_setting").click(function(){var t=!1;if($(".btn_transfer_fee_edit").each(function(e,a){"none"==$(a).css("display")&&(t=!0)}),$(".btn_deposit_edit").each(function(e,a){"none"==$(a).css("display")&&(t=!0)}),t)return void show_toast_notif("error","Error","Please finish your update in the transfer fee table and deposit settings before save",function(){});var e="disabled";"checked"==$(".cb_deposit").parent()[0].className&&(e="enabled");var a="disabled";"checked"==$(".cb_transfer").parent()[0].className&&(a="enabled");var n=$(".txt_max_transfer_day").val(),r=$(".txt_max_coin_day").val(),i=$(".txt_max_coin_time").val(),s=$(".txt_max_fail_day").val(),d=$(".txt_time_between").val(),o=getDataFromTable("table_transfer_fee"),_=getDataFromTable("table_deposit");o.sort(compare_transfer_item),_.sort(compare_deposit_item);var l=[{id:1,value:e},{id:2,value:a},{id:3,value:n},{id:4,value:r},{id:5,value:i},{id:6,value:s},{id:7,value:d},{id:8,value:JSON.stringify(o)},{id:9,value:JSON.stringify(_)}];$.ajax({url:base_request_url+"/admin/walletConfig",type:"PUT",data:JSON.stringify(l),contentType:"application/json",dataType:"json",beforeSend:function(t){t.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(t){"Success"==t.onlyMessage?(reload_form(),show_toast_notif("success","Updated","e-Wallet settings updated",function(){})):show_toast_notif("error","Error","Fail to update wallet config informations",function(){})},error:function(t){show_toast_notif("error","Error","Error message '"+t.responseText+"'",function(){})}})})};jQuery(document).ready(function(){Page_script.init(),load_page()});