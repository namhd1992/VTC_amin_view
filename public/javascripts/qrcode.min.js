function str_pad(e){return String("00"+e).slice(-2)}var editing_item=null,item_name="QR code",item_names="QR codes",deleted_id=null,channel_arr=[],page_datatable=null;_current_page=1;var doneTypingInterval=1e3,searching_value_timeout="",typingTimer,match_filter_id=null,search_value=null,Page_script=function(){return{init:function(){}}}(),load_page=function(){_send_info.data={limit:_per_page,offset:0},$(".bs-select").selectpicker({iconBase:"fa",tickIcon:"fa-check"});var e=function(e){channel_arr.splice(channel_arr.indexOf(e),1)};page_datatable=$("#page_datatable").DataTable({ajax:{url:base_request_url+"/admin/qrCode",type:"GET",data:function(e){null!=search_value&&""!=search_value&&(e.searchValue=search_value),e.limit=_per_page,e.offset=_per_page*(_current_page-1)},contentType:"application/json",dataType:"json",dataSrc:function(e){var t=0;if($(".datatable_paging").html(""),e.totalRecords>_per_page)for(t=1;t<=Math.ceil(e.totalRecords/_per_page);t++)t==_current_page?$(".datatable_paging").append("<span class='datatable_paging_number_active' page="+t+">"+t+"</span>"):1!=t&&t!=Math.ceil(e.totalRecords/_per_page)&&t!=_current_page-1&&t!=_current_page-2&&t!=_current_page+2&&t!=_current_page+1||(1==t&&_current_page>4?($(".datatable_paging").append("<span class='datatable_paging_number' page="+t+">"+t+"</span>"),$($(".datatable_paging_number")[0]).after("<span class='paging_truncate'>...</span>")):t==Math.ceil(e.totalRecords/_per_page)&&_current_page<Math.ceil(e.totalRecords/_per_page)-3?($(".datatable_paging").append("<span class='datatable_paging_number' page="+t+">"+t+"</span>"),$($(".datatable_paging_number")[$(".datatable_paging_number").length-1]).before("<span class='paging_truncate'>...</span>")):$(".datatable_paging").append("<span class='datatable_paging_number' page="+t+">"+t+"</span>"));else $(".datatable_paging").html("<span class='datatable_paging_number_active' page=1>1</span>");return $(".datatable_paging_number").click(function(e){_current_page=parseInt($(e.target).attr("page")),page_datatable.ajax.reload()}),e.dataArr},beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},error:function(e,t,a){"invalid_token"==JSON.parse(e.responseText).error&&(localStorage.removeItem("user_data"),document.location.replace("login"))}},columns:[{title:"ID",data:"id"},{title:"Name",data:"name"},{title:"Service",data:null,render:function(e,t,a,n){e="";var i=JSON.parse(a.data);return e+=i.service}},{title:"Created on",data:null,render:function(e,t,a,n){var i=getSetting(_setting_data,"date_format"),s=moment.unix(a.createOn/1e3).format(i.value);return s}},{title:"Action",data:null,render:function(e,t,a,n){return e="",e+="<a class='btn_view_item' item_id='"+a.id+"' item_obj='"+JSON.stringify(a)+"'><i class='icon-eye'></i> View </a>",e+="<a class='btn_delete_item' item_id='"+a.id+"' item_obj='"+JSON.stringify(a)+"'><i class='icon-trash'></i> Delete </a>"}}],aoColumnDefs:[{sWidth:"5%",aTargets:[0]},{sWidth:"20%",aTargets:[1]},{sWidth:"20%",aTargets:[2]},{sWidth:"20%",aTargets:[3]},{sWidth:"20%",aTargets:[4]}],autoWidth:!1,lengthChange:!1,info:!1,bSort:!1,bPaginate:!1,bFilter:!1,fnDrawCallback:function(e){$("div.dataTables_wrapper div.dataTables_filter label").contents().filter(function(){return 1!=this.nodeType}).replaceWith(""),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("form-control"),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("input-inline"),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("input-medium"),$("div.dataTables_wrapper div.dataTables_filter label input").attr("placeholder","Search..."),$("div.dataTables_wrapper div.dataTables_filter label input").attr("id","inputSuccess"),$(".btn_view_item").click(function(){var e=JSON.parse($(this).attr("item_obj"));editing_item=e.id,$(".img_view_qrcode").attr("src",e.urlImage),$(".btn_download").attr("href",e.urlImage),$("#modal_view").modal("show")}),$(".btn_delete_item").click(function(){deleted_id=parseInt($(this).attr("item_id")),$("#modal_confirm").modal("show")})}});var t=function(){function a(e){if(e.loading)return e.text;var t="<div class='select2-result-repository clearfix'><div class='select2-result-repository__avatar'><img src='"+e.owner.avatar_url+"' /></div><div class='select2-result-repository__meta'><div class='select2-result-repository__title'>"+e.full_name+"</div>";return e.description&&(t+="<div class='select2-result-repository__description'>"+e.description+"</div>"),t+="<div class='select2-result-repository__statistics'><div class='select2-result-repository__forks'><span class='glyphicon glyphicon-flash'></span> "+e.forks_count+" Forks</div><div class='select2-result-repository__stargazers'><span class='glyphicon glyphicon-star'></span> "+e.stargazers_count+" Stars</div><div class='select2-result-repository__watchers'><span class='glyphicon glyphicon-eye-open'></span> "+e.watchers_count+" Watchers</div></div></div></div>"}function n(e){return e.full_name||e.text}$.fn.select2.defaults.set("theme","bootstrap");var i="Type to search";$(".select2, .select2-multiple").select2({placeholder:i,width:null}),$(".select2-allow-clear").select2({allowClear:!0,placeholder:i,width:null}),$(".js-data-example-ajax").select2({width:"off",ajax:{url:"https://api.github.com/search/repositories",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,t){return{results:e.items}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1,templateResult:a,templateSelection:n}),$("button[data-select2-open]").click(function(){$("#"+$(this).data("select2-open")).select2("open")}),$(":checkbox").on("click",function(){$(this).parent().nextAll("select").prop("disabled",!this.checked)}),$(".select2, .select2-multiple, .select2-allow-clear, .js-data-example-ajax").on("select2:open",function(){if($(this).parents("[class*='has-']").length)for(var e=$(this).parents("[class*='has-']")[0].className.split(/\s+/),a=0;a<e.length;++a)e[a].match("has-")&&$("body > .select2-container").addClass(e[a]);"single_select_betting"==$(this).attr("id")&&(console.log(match_filter_id),typing_input=$(".select2-search__field")[0],$(typing_input).on("keypress",function(){console.log("press"),clearTimeout(typingTimer),typingTimer=setTimeout(function(){_send_info.data={limit:5,offset:0,searchValue:$(typing_input).val()},null!=match_filter_id&&(_send_info.data.matchId=match_filter_id),searching_value_timeout=$(typing_input).val(),$("#single_select_betting").html(""),$.ajax({url:base_request_url+"/admin/bettingEvent",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){console.log("success");$(e.dataArr).each(function(e,t){$("#single_select_betting").append("<option value='"+t.id+"'> "+t.name+"</option>")}),t(),$("#single_select_betting").select2("open"),$($(".select2-search__field")[0]).val(searching_value_timeout)},error:function(e){console.log("error"),console.log(e.error())}})},doneTypingInterval)})),"single_select_match"==$(this).attr("id")&&(typing_input=$(".select2-search__field")[0],$(typing_input).on("keypress",function(){console.log("press"),clearTimeout(typingTimer),typingTimer=setTimeout(function(){_send_info.data={limit:5,offset:0,searchValue:$(typing_input).val()},searching_value_timeout=$(typing_input).val(),$("#single_select_match").html(""),$.ajax({url:base_request_url+"/admin/matchs",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){console.log("success");$(e.dataArr).each(function(e,t){$("#single_select_match").append("<option value='"+t.id+"'> "+t.name+"</option>")}),match_filter_id=e.dataArr[0].id,$("#single_select_betting").html(""),t(),$("#single_select_match").select2("open"),$($(".select2-search__field")[0]).val(searching_value_timeout)},error:function(e){console.log("error"),console.log(e.error())}})},doneTypingInterval)})),"single_select_lucky"==$(this).attr("id")&&(typing_input=$(".select2-search__field")[0],$(typing_input).on("keypress",function(){console.log("press"),clearTimeout(typingTimer),typingTimer=setTimeout(function(){_send_info.data={limit:5,offset:0,searchValue:$(typing_input).val()},searching_value_timeout=$(typing_input).val(),$("#single_select_lucky").html(""),$.ajax({url:base_request_url+"/admin/luckySpin",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){console.log("success");$(e.dataArr).each(function(e,t){$("#single_select_lucky").append("<option value='"+t.id+"'> "+t.name+"</option>")}),t(),$("#single_select_lucky").select2("open"),$($(".select2-search__field")[0]).val(searching_value_timeout)},error:function(e){console.log("error"),console.log(e.error())}})},doneTypingInterval)})),"single_select_giftcode"==$(this).attr("id")&&(typing_input=$(".select2-search__field")[0],$(typing_input).on("keypress",function(){console.log("press"),clearTimeout(typingTimer),typingTimer=setTimeout(function(){_send_info.data={limit:5,offset:0,searchValue:$(typing_input).val()},searching_value_timeout=$(typing_input).val(),$("#single_select_giftcode").html(""),$.ajax({url:base_request_url+"/admin/giftcodeEvent",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){console.log("success");$(e.dataArr).each(function(e,t){$("#single_select_giftcode").append("<option value='"+t.giftcodeEvent.id+"'> "+t.title+"</option>")}),t(),$("#single_select_giftcode").select2("open"),$($(".select2-search__field")[0]).val(searching_value_timeout)},error:function(e){console.log("error"),console.log(e.error())}})},doneTypingInterval)}))}),$(".js-btn-set-scaling-classes").on("click",function(){$("#select2-multiple-input-sm, #select2-single-input-sm").next(".select2-container--bootstrap").addClass("input-sm"),$("#select2-multiple-input-lg, #select2-single-input-lg").next(".select2-container--bootstrap").addClass("input-lg"),$(this).removeClass("btn-primary btn-outline").prop("disabled",!0)}),$("#single_select").change(function(){var t=parseInt($("#single_select").val());$.inArray(t,channel_arr)==-1&&(channel_arr.push(t),$(".current_channels").append("<span channel_id='"+t+"' class='tag label label-warning'><i class='fa fa-wrench'></i> "+$("#single_select option:selected").text()+"<span class='remove_channel' data-role='remove'></span></span>"),$(".txt_add_edit_item_channel").val(t),$(".current_channels .remove_channel").click(function(){$(".txt_add_edit_item_channel").val(""),e(parseInt($(this).parent().attr("channel_id"))),$(this).parent().remove()}))})};_send_info.data={limit:5,offset:0},$.ajax({url:base_request_url+"/admin/giftcodeEvent",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){$(e.dataArr).each(function(e,t){$("#single_select_giftcode").append("<option value='"+t.giftcodeEvent.id+"'> "+t.title+"</option>")}),t()},error:function(e){console.log(e.error())}}),$.ajax({url:base_request_url+"/admin/luckySpin",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){$(e.dataArr).each(function(e,t){$("#single_select_lucky").append("<option value='"+t.id+"'> "+t.name+"</option>")}),t()},error:function(e){console.log(e.error())}}),$.ajax({url:base_request_url+"/admin/matchs",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){$(e.dataArr).each(function(e,t){$("#single_select_match").append("<option value='"+t.id+"'> "+t.name+"</option>")}),t()},error:function(e){console.log(e.error())}}),$.ajax({url:base_request_url+"/admin/bettingEvent",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){$(e.dataArr).each(function(e,t){$("#single_select_betting").append("<option value='"+t.id+"'> "+t.name+"</option>")}),t()},error:function(e){console.log(e.error())}}),$(".btn_add_new_item").click(function(){$("#modal_add_edit .modal-title").html("Create new "+item_name),$("#modal_add_edit input:text").val(""),$("#modal_add_edit textarea").val(""),$(".hidden_add_edit_item_condidion").attr("name","conditionId"),$(".txt_add_edit_item_channel").attr("name","channelId"),$(".cb_add_edit_item_condition span").removeClass("checked"),$(".current_channels").html(""),$(".file_add_edit_item_giftcode").parent().parent().show(),$(".file_add_edit_item_giftcode").attr("name","giftCodeFile"),$(".group_betting").show(),$(".group_luckyspin").hide(),$(".group_giftcode").hide(),channel_arr=[],$("#modal_add_edit .btn_modal_save_new").show(),$("#modal_add_edit .btn_modal_save_update").hide(),$(".hidden_giftcode_id").remove(),$("#modal_add_edit").modal("show")}),$("#single_select_service").change(function(e){"betting"==$(this).val()?($(".group_betting").show(),$(".group_luckyspin").hide(),$(".group_giftcode").hide()):"luckyspin"==$(this).val()?($(".group_betting").hide(),$(".group_luckyspin").show(),$(".group_giftcode").hide()):"giftcode"==$(this).val()&&($(".group_betting").hide(),$(".group_luckyspin").hide(),$(".group_giftcode").show())}),$("#single_select_match").change(function(){match_filter_id=$(this).val()}),$(".search_submit").click(function(){search_value=$(".search_input").val(),page_datatable.ajax.reload(null,!1)}),$(".search_clear").click(function(){$(".search_input").val(""),search_value="",page_datatable.ajax.reload(null,!1)}),$("#page_datatable").on("order.dt",function(){}).on("search.dt",function(e){}).dataTable()};jQuery(document).ready(function(){Page_script.init(),load_page(),$(".date-picker").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0}),$(".btn_confirm_yes").click(function(){$.ajax({url:base_request_url+"/admin/qrCode?id="+deleted_id,type:"DELETE",contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(){$("#modal_confirm").modal("hide"),_send_info.data={},page_datatable.ajax.reload(),$("#modal_add_edit").modal("hide"),show_toast_notif("success","Successfully","Deleted: '"+deleted_id+"'",function(){})},error:function(e){show_toast_notif("error","Error","'"+e.responseText+"'",function(){})}})}),$(".btn_modal_save_new").click(function(){$(".loading_icon").show();var e=0;"betting"==$("#single_select_service").val()?e=$("#single_select_betting").val():"luckyspin"==$("#single_select_service").val()?e=$("#single_select_lucky").val():"giftcode"==$("#single_select_service").val()&&(e=$("#single_select_giftcode").val()),_send_info.data={service:$("#single_select_service").val(),sizeImage:$(".txt_add_edit_size").val(),id:e},$.ajax({url:base_request_url+"/admin/qrCode",type:"POST",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){$("#modal_add_edit").modal("hide"),page_datatable.ajax.reload(null,!1),"Success"==e.onlyMessage?show_toast_notif("success","Successfully","Created '"+$(".txt_add_edit_item_name").val()+"'"):show_toast_notif("error","Error","Unable to create QR code"),$(".loading_icon").hide()},error:function(e){$(".loading_icon").hide(),show_toast_notif("error","Error","Error info: "+e.responseText)}})}),$(".btn_modal_save_update").click(function(){_send_info.data={id:editing_item,name:$(".txt_add_edit_item_name").val(),status:$(".select_status option:selected").val(),functionList:channel_arr},$.ajax({url:base_request_url+"/admin/groupRole",type:"PUT",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){$("#modal_add_edit").modal("hide"),page_datatable.ajax.reload(null,!1),"Success"==e.onlyMessage?show_toast_notif("success","Successfully","Updated '"+$(".txt_add_edit_item_name").val()+"' please re-login to update permissions",function(){}):show_toast_notif("error","Error","Unable to update role",function(){})},error:function(e){show_toast_notif("error","Error","Error info: "+e.responseText,function(){})}})}),$(".select_status").change(function(){"active"==$(this).val()?$(".select_status button").css("background-color","#32c5d2"):"inactive"==$(this).val()&&$(".select_status button").css("background-color","red")}),checkFunction("createGroupRole")||$(".btn_add_new_item").remove()});