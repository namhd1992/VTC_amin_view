var editing_item=null,item_name="Article",item_names="Articles",deleted_id=null,page_datatable=null,data_list=null;_current_page=1;var search_value=null,Page_script=function(){return{init:function(){}}}(),load_page=function(){_send_info.data={limit:10,offset:0},$(".bs-select").selectpicker({iconBase:"fa",tickIcon:"fa-check"}),page_datatable=$("#page_datatable").DataTable({ajax:{url:base_request_url+"/admin/article",type:"get",data:function(a){var t=$(".filter_link_active").attr("status_val"),e={limit:_per_page,offset:_per_page*(_current_page-1)};return"all"!=t&&(e.status=t),null!=search_value&&(e.searchValue=search_value),e},contentType:"application/json",dataType:"json",dataSrc:function(a){var t=$(".filter_link_active").attr("status_val");data_list=a.dataArr;var e=(a.totalRecords,0),n=0;$(data_list).each(function(a,i){"active"==i.status?e++:n++,"all"!=t&&i.status!=t&&data_list.splice(data_list.indexOf(i),1)}),$.ajax({url:base_request_url+"/admin/article?limit=1&offset=0&status=active",type:"get",contentType:"application/json",dataType:"json",beforeSend:function(a){a.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(a){$(".filter_active").html(a.totalRecords)},error:function(a){console.log(a)}}),$.ajax({url:base_request_url+"/admin/article?limit=1&offset=0&status=inactive",type:"get",contentType:"application/json",dataType:"json",beforeSend:function(a){a.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(a){$(".filter_inactive").html(a.totalRecords)},error:function(a){console.log(a)}}),$.ajax({url:base_request_url+"/admin/article?limit=1&offset=0",type:"get",contentType:"application/json",dataType:"json",beforeSend:function(a){a.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(a){$(".filter_all").html(a.totalRecords)},error:function(a){console.log(a)}});var i=0;if($(".datatable_paging").html(""),a.totalRecords>_per_page)for(i=1;i<=Math.ceil(a.totalRecords/_per_page);i++)i==_current_page?$(".datatable_paging").append("<span class='datatable_paging_number_active' page="+i+">"+i+"</span>"):1!=i&&i!=Math.ceil(a.totalRecords/_per_page)&&i!=_current_page-1&&i!=_current_page-2&&i!=_current_page+2&&i!=_current_page+1||(1==i&&_current_page>4?($(".datatable_paging").append("<span class='datatable_paging_number' page="+i+">"+i+"</span>"),$($(".datatable_paging_number")[0]).after("<span class='paging_truncate'>...</span>")):i==Math.ceil(a.totalRecords/_per_page)&&_current_page<Math.ceil(a.totalRecords/_per_page)-3?($(".datatable_paging").append("<span class='datatable_paging_number' page="+i+">"+i+"</span>"),$($(".datatable_paging_number")[$(".datatable_paging_number").length-1]).before("<span class='paging_truncate'>...</span>")):$(".datatable_paging").append("<span class='datatable_paging_number' page="+i+">"+i+"</span>"));else $(".datatable_paging").html("<span class='datatable_paging_number_active' page=1>1</span>");return $(".datatable_paging_number").click(function(a){_current_page=parseInt($(a.target).attr("page")),page_datatable.ajax.reload()}),data_list},beforeSend:function(a){a.setRequestHeader("Authorization","bearer "+_user_data.access_token)},error:function(a,t,e){"invalid_token"==JSON.parse(a.responseText).error&&(localStorage.removeItem("user_data"),document.location.replace("login"))}},columns:[{title:"Img",data:null,render:function(a,t,e,n){var i="";return i+="<img src='"+e.defaultImage+"' />"}},{title:"Title",data:null,render:function(a,t,e,n){var i="";return i+="<div class='title_content'>",i+=e.title,i+="</div>"}},{title:"Author",data:"author"},{title:"Publisher",data:null,render:function(a,t,e,n){return e.publisher.name}},{title:"<i class='fa fa-commenting'></i>",data:null,render:function(a,t,e,n){return e.numberComment}},{title:"Tags",data:null,render:function(a,t,e,n){var i="";return $(e.tagsList).each(function(a,t){i+=t.name+", "}),i}},{title:"Date",data:null,render:function(a,t,e,n){var i=getSetting(_setting_data,"date_format"),l=moment.unix(e.createOn/1e3).format(i.value);return l}},{title:"Actions",data:null,render:function(a,t,e,n){var i="";return i+="<a class='btn_edit_item' item_id='"+e.id+"' item_obj='"+escape(JSON.stringify(e))+"' ><i class='icon-wrench'></i> Edit </a>"}}],aoColumnDefs:[{sWidth:"5%",aTargets:[0]},{sWidth:"25%",aTargets:[1]},{sWidth:"10%",aTargets:[2]},{sWidth:"7%",aTargets:[3]},{sWidth:"3%",aTargets:[4]},{sWidth:"20%",aTargets:[5]},{sWidth:"15%",aTargets:[6]},{sWidth:"5%",aTargets:[7]}],autoWidth:!1,lengthChange:!1,info:!1,bSort:!1,bFilter:!1,bPaginate:!1,fnDrawCallback:function(a){$("div.dataTables_wrapper div.dataTables_filter label").contents().filter(function(){return 1!=this.nodeType}).replaceWith(""),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("form-control"),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("input-inline"),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("input-medium"),$("div.dataTables_wrapper div.dataTables_filter label input").attr("placeholder","Search..."),$("div.dataTables_wrapper div.dataTables_filter label input").attr("id","inputSuccess"),$(".btn_edit_item").click(function(){editing_item=$(this).attr("item_id");var a=findBy(data_list,editing_item,"id");$("#modal_add_edit .modal-title").html("Edit "+item_name+" "+a.id),$("#modal_add_edit .area_add_edit_item_title").val(a.title),$("#modal_add_edit .txt_add_edit_item_image").val(a.defaultImage),$("#modal_add_edit .btn_modal_save_new").hide(),$("#modal_add_edit .btn_modal_save_update").show(),jQuery(".select_status option").filter(function(){return $.trim($(this).val())==a.status}).prop("selected",!0),$(".select_status").selectpicker("refresh"),"active"==a.status?$(".select_status button").css("background-color","#32c5d2"):$(".select_status button").css("background-color","red"),$("#modal_add_edit").modal("show")}),$(".btn_delete_item").click(function(){deleted_id=parseInt($(this).attr("item_id")),$("#modal_confirm").modal("show")})}}),$("#page_datatable").on("order.dt",function(){}).on("search.dt",function(){}).on("page.dt",function(){}).dataTable()};jQuery(document).ready(function(){Page_script.init(),load_page(),$(".search_submit").click(function(){search_value=$(".search_input").val(),page_datatable.ajax.reload(null,!1)}),$(".search_clear").click(function(){$(".search_input").val(""),search_value="",page_datatable.ajax.reload(null,!1)}),$(".btn_add_new_item").click(function(){$("#modal_add_edit .modal-title").html("Create new "+item_name),$("#modal_add_edit .txt_add_edit_channel_name").val(""),$("#modal_add_edit .txt_add_edit_channel_image").val(""),$("#modal_add_edit .btn_modal_save_new").show(),$("#modal_add_edit .btn_modal_save_update").hide(),$(".current_tags").html(" "),$(".current_packages").html(" "),$("#modal_add_edit").modal("show")}),$(".btn_modal_save_update").click(function(){_send_info.data={title:$(".area_add_edit_item_title").val(),status:$(".select_status option:selected").val(),defaultImage:$(".txt_add_edit_item_image").val(),newsId:editing_item},$.ajax({url:base_request_url+"/admin/article",type:"PUT",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(a){a.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(){_send_info.data={limit:1e4,offset:0},page_datatable.ajax.reload(null,!1),$("#modal_add_edit").modal("hide"),show_toast_notif("success","Successfully","Updated '"+editing_item+"'",function(){})},error:function(a){show_toast_notif("error","Successfully","Error '"+a.responseText+"'",function(){})}})}),$(".filter_link").click(function(){$(".filter_link").removeClass("filter_link_active"),$(this).addClass("filter_link_active"),page_datatable.ajax.reload(null,!1)}),$(".select_status").change(function(){"active"==$(this).val()?$(".select_status button").css("background-color","#32c5d2"):"inactive"==$(this).val()&&$(".select_status button").css("background-color","red")})});