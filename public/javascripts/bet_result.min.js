function str_pad(t){return String("00"+t).slice(-2)}function objectifyForm(t){for(var e={},a=0;a<t.length;a++)e[t[a].name]=t[a].value;return e}function get_data_by_name(t,e){var a=null;return $(t).each(function(t,n){n.name==e&&(a=n)}),a}var page_datatable=null,search_value=null,editing_obj=null,item_name="Result",item_names="Results";_per_page=5;var Page_script=function(){return{init:function(){}}}(),load_page=function(){$(".loading_icon").show(),page_datatable=$("#page_datatable").DataTable({ajax:{url:base_request_url+"/admin/bettingEvent",type:"GET",data:function(t){null!=search_value&&""!=search_value&&(t.searchValue=search_value),t.limit=1e4,t.offset=0,t.inBet=2},contentType:"application/json",dataType:"json",dataSrc:function(t){console.log(t);var e=[];$(t.dataArr).each(function(t,a){e.push(a.inMatch.id+"-"+a.id)});const a=io("https://socket.simba-app.com");return a.on("connect",function(){console.log("connected"),$(".loading_icon").hide(),$(e).each(function(t,e){a.on(e,function(t){$(".ticket_"+e).parent().removeClass("changing"),$(".ticket_"+e).parent().addClass("changing"),$(".ratio_"+e).parent().removeClass("changing"),$(".ratio_"+e).parent().addClass("changing"),$(".amount_"+e).parent().removeClass("changing"),$(".amount_"+e).parent().addClass("changing"),$(".ticket_"+e).html(t.dataResponse.countFirstTeam+" - "+t.dataResponse.countSecondTeam),$(".ratio_"+e).html(t.dataResponse.ratioBetFirstTeam+" - "+t.dataResponse.ratioBetSecondTeam),$(".amout_"+e).html(t.dataResponse.amountBetFirstTeam+" - "+t.dataResponse.amountBetSecondTeam)})})}),a.open(),$(".loading_icon_inbet_match").hide(),null!=t.dataArr?t.dataArr:[]},beforeSend:function(t){t.setRequestHeader("Authorization","bearer "+_user_data.access_token)},error:function(t,e,a){"invalid_token"==JSON.parse(t.responseText).error&&(localStorage.removeItem("user_data"),document.location.replace("login"))}},columns:[{title:"ID",data:"id"},{title:"Match",data:"inMatch.name"},{title:"Name",data:"name"},{title:"Teams",data:null,render:function(t,e,a,n){var o="";return o+=a.inMatch.firstTeam.name+" - "+a.inMatch.secondTeam.name}},{title:"Ratio",data:null,render:function(t,e,a,n){var o="";return o+="<span class='live_info ratio_"+a.inMatch.id+"-"+a.id+"'>"+a.bettingRatios[0].firstTeamRatio+" - "+a.bettingRatios[0].secondTeamRatio+"</div>"}},{title:"Tickets",data:null,render:function(t,e,a,n){var o="";return o+="<span class='live_info ticket_"+a.inMatch.id+"-"+a.id+"'>"+a.totalBetEventBean.totalPersonBetFirstTeam+" - "+a.totalBetEventBean.totalPersonBetSecondTeam+"</div>"}},{title:"Amount",data:null,render:function(t,e,a,n){var o="";return o+="<span class='live_info amount_"+a.inMatch.id+"-"+a.id+"'>"+a.totalBetEventBean.totalAmountBetFirstTeam+" - "+a.totalBetEventBean.totalAmountBetSecondTeam+"</div>"}},{title:"Action",data:null,render:function(t,e,a,n){var o="";return o+="<a class='btn_edit_item' item_id='"+a.id+"' item_obj='"+JSON.stringify(a)+"'><i class='icon-wrench'></i> Update </a>"}}],aoColumnDefs:[{sWidth:"2%",aTargets:[0]},{sWidth:"10%",aTargets:[1]},{sWidth:"10%",aTargets:[2]},{sWidth:"20%",aTargets:[3]},{sWidth:"10%",className:"dt-center",aTargets:[4]},{sWidth:"10%",className:"dt-center",aTargets:[5]},{sWidth:"15%",className:"dt-center",aTargets:[6]},{sWidth:"10%",aTargets:[7]}],autoWidth:!1,lengthChange:!1,info:!1,bSort:!1,bFilter:!1,bPaginate:!1,fnDrawCallback:function(t){$("div.dataTables_wrapper div.dataTables_filter label").contents().filter(function(){return 1!=this.nodeType}).replaceWith(""),$(".btn_edit_item").click(function(){var t=JSON.parse($(this).attr("item_obj"));console.log(t),editing_item=t.id,editing_obj=t,$("#modal_add_edit .modal-title").html("Edit "+item_name+" "+t.name),$("#modal_add_edit .txt_add_edit_item_name").val(t.name),$("#single_select_match").val(t.inMatch.id),load_autocomplete_component(),$(".txt_add_edit_item_date_start").val(moment.unix(t.startBettingTime/1e3).format("YYYY-MMMM-D HH:mm")),$(".txt_add_edit_item_date_end").val(moment.unix(t.endBettingTime/1e3).format("YYYY-MMMM-D HH:mm")),$(".txt_first_team_ratio").val(t.bettingRatios[0].firstTeamRatio),$(".txt_second_team_ratio").val(t.bettingRatios[0].secondTeamRatio),$(".team1_winner").html(t.inMatch.firstTeam.name),$(".help_team1").html(t.inMatch.firstTeam.name),$(".team2_winner").html(t.inMatch.secondTeam.name),$(".help_team2").html(t.inMatch.secondTeam.name),$("#modal_add_edit .btn_modal_save_new").hide(),$("#modal_add_edit .btn_modal_save_update").show(),1==t.betType?2==t.teamWon?$(".result_amount").html(Math.round(t.totalBetEventBean.totalAmountBetFirstTeam+t.totalBetEventBean.totalAmountBetSecondTeam-t.totalBetEventBean.amountCashBackSecondTeam)):$(".result_amount").html(Math.round(t.totalBetEventBean.totalAmountBetFirstTeam+t.totalBetEventBean.totalAmountBetSecondTeam-t.totalBetEventBean.amountCashBackFirstTeam)):2==t.teamWon?$(".result_amount").html(Math.round(t.totalBetEventBean.totalAmountBetFirstTeam+t.totalBetEventBean.totalAmountBetSecondTeam-t.totalBetEventBean.totalAmountBetSecondTeam*t.bettingRatios[0].secondTeamRatio)):$(".result_amount").html(Math.round(t.totalBetEventBean.totalAmountBetFirstTeam+t.totalBetEventBean.totalAmountBetSecondTeam-t.totalBetEventBean.totalAmountBetFirstTeam*t.bettingRatios[0].firstTeamRatio)),2==t.teamWon?$(".select_winner").val(2):$(".select_winner").val(1),$(".select_winner").selectpicker("refresh"),$(".select_bet_type option").filter(function(){return $.trim($(this).val())==t.betType}).prop("selected",!0),$(".select_bet_type").selectpicker("refresh"),$(".select_status option").filter(function(){return $.trim($(this).val())==t.status}).prop("selected",!0),$(".select_status").selectpicker("refresh"),"active"==t.status?$(".select_status button").css("background-color","#32c5d2"):$(".select_status button").css("background-color","red"),$(".btn_delete_item").show(),$(".btn_delete_item").attr("item_id",t.id),$("#modal_add_edit").modal("show")})}}),$(".btn_confirm_yes").click(function(){new Date($(".txt_add_edit_item_date_start").val()).getTime(),new Date($(".txt_add_edit_item_date_end").val()).getTime();_send_info.data={bettingEventId:editing_item,name:$(".txt_add_edit_item_name").val(),startBettingTime:1e3*new moment($(".txt_add_edit_item_date_start").val(),"YYYY-MMMM-D hh:mm").unix(),endBettingTime:1e3*new moment($(".txt_add_edit_item_date_end").val(),"YYYY-MMMM-D hh:mm").unix(),matchId:$("#single_select_match").val(),betType:$(".select_bet_type option:selected").val(),firstTeamRatio:$(".txt_first_team_ratio").val(),secondTeamRatio:$(".txt_second_team_ratio").val(),status:$(".select_status option:selected").val(),teamWon:$(".select_winner option:selected").val()},$(".loading_icon").show(),$.ajax({url:base_request_url+"/admin/bettingEvent",type:"PUT",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(t){t.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(t){$("#modal_confirm").modal("hide"),page_datatable.ajax.reload(null,!1),"Success"==t.onlyMessage?(show_toast_notif("success","Successfully","Updated '"+$(".txt_add_edit_item_name").val()+"'"),$("#modal_add_edit").modal("hide")):show_toast_notif("error","Fail",t.onlyMessage),$(".loading_icon").hide()},error:function(t){$("#modal_confirm").modal("hide"),show_toast_notif("error","Fail","Error '"+t.responseText+"'"),$(".loading_icon").hide()}})}),$(".btn_modal_save_update").click(function(){$("#modal_confirm").modal("show")}),$(".select_winner").change(function(){1==editing_obj.betType?2==$(this).val()?$(".result_amount").html(Math.round(editing_obj.totalBetEventBean.totalAmountBetFirstTeam+editing_obj.totalBetEventBean.totalAmountBetSecondTeam-editing_obj.totalBetEventBean.amountCashBackSecondTeam)):$(".result_amount").html(Math.round(editing_obj.totalBetEventBean.totalAmountBetFirstTeam+editing_obj.totalBetEventBean.totalAmountBetSecondTeam-editing_obj.totalBetEventBean.amountCashBackFirstTeam)):2==$(this).val()?$(".result_amount").html(Math.round(editing_obj.totalBetEventBean.totalAmountBetFirstTeam+editing_obj.totalBetEventBean.totalAmountBetSecondTeam-editing_obj.totalBetEventBean.totalAmountBetSecondTeam*editing_obj.bettingRatios[0].secondTeamRatio)):$(".result_amount").html(Math.round(editing_obj.totalBetEventBean.totalAmountBetFirstTeam+editing_obj.totalBetEventBean.totalAmountBetSecondTeam-editing_obj.totalBetEventBean.totalAmountBetFirstTeam*editing_obj.bettingRatios[0].firstTeamRatio))}),$(".btn_refresh").click(function(){$(".loading_icon_inbet_match").show(),page_datatable.ajax.reload()}),_send_info.data={limit:1e4,offset:0},$.ajax({url:base_request_url+"/admin/matchs",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(t){t.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(t){console.log(t),$(t.dataArr).each(function(t,e){$("#single_select_match").append("<option value='"+e.id+"'> "+e.name+"</option>")}),void 0!=t.dataArr[0]&&($("#single_select_match").val(t.dataArr[0].id),$(".team1_winner").html(t.dataArr[0].firstTeam.name),$(".help_team1").html(t.dataArr[0].firstTeam.name),$(".team2_winner").html(t.dataArr[0].secondTeam.name),$(".help_team2").html(t.dataArr[0].secondTeam.name),load_autocomplete_component())},error:function(t){console.log(t.error())}})};load_autocomplete_component=function(){function t(t){if(t.loading)return t.text;var e="<div class='select2-result-repository clearfix'><div class='select2-result-repository__avatar'><img src='"+t.owner.avatar_url+"' /></div><div class='select2-result-repository__meta'><div class='select2-result-repository__title'>"+t.full_name+"</div>";return t.description&&(e+="<div class='select2-result-repository__description'>"+t.description+"</div>"),e+="<div class='select2-result-repository__statistics'><div class='select2-result-repository__forks'><span class='glyphicon glyphicon-flash'></span> "+t.forks_count+" Forks</div><div class='select2-result-repository__stargazers'><span class='glyphicon glyphicon-star'></span> "+t.stargazers_count+" Stars</div><div class='select2-result-repository__watchers'><span class='glyphicon glyphicon-eye-open'></span> "+t.watchers_count+" Watchers</div></div></div></div>"}function e(t){return t.full_name||t.text}$.fn.select2.defaults.set("theme","bootstrap");var a="Type to search";$(".select2, .select2-multiple").select2({placeholder:a,width:null}),$(".select2-allow-clear").select2({allowClear:!0,placeholder:a,width:null}),$(".js-data-example-ajax").select2({width:"off",ajax:{url:"https://api.github.com/search/repositories",dataType:"json",delay:250,data:function(t){return{q:t.term,page:t.page}},processResults:function(t,e){return{results:t.items}},cache:!0},escapeMarkup:function(t){return t},minimumInputLength:1,templateResult:t,templateSelection:e}),$("button[data-select2-open]").click(function(){$("#"+$(this).data("select2-open")).select2("open")}),$(":checkbox").on("click",function(){$(this).parent().nextAll("select").prop("disabled",!this.checked),1==$(this).val()&&$(this).parent().hasClass("checked")?($(".appname_group").show(),$(".txt_add_edit_item_package_android").attr("name","androidPackage"),$(".txt_add_edit_item_package_ios").attr("name","iosSchemes")):1!=$(this).val()||$(this).parent().hasClass("checked")||($(".appname_group").hide(),$(".txt_add_edit_item_package_android").attr("name",""),$(".txt_add_edit_item_package_ios").attr("name","")),3==$(this).val()&&$(this).parent().hasClass("checked")?($(".share_group").show(),$(".txt_add_edit_item_share").attr("name","urlShareFB")):3!=$(this).val()||$(this).parent().hasClass("checked")||($(".share_group").hide(),$(".txt_add_edit_item_share").attr("name",""))}),$(".select2, .select2-multiple, .select2-allow-clear, .js-data-example-ajax").on("select2:open",function(){if($(this).parents("[class*='has-']").length)for(var t=$(this).parents("[class*='has-']")[0].className.split(/\s+/),e=0;e<t.length;++e)t[e].match("has-")&&$("body > .select2-container").addClass(t[e])}),$(".js-btn-set-scaling-classes").on("click",function(){$("#select2-multiple-input-sm, #select2-single-input-sm").next(".select2-container--bootstrap").addClass("input-sm"),$("#select2-multiple-input-lg, #select2-single-input-lg").next(".select2-container--bootstrap").addClass("input-lg"),$(this).removeClass("btn-primary btn-outline").prop("disabled",!0)})},$(document).ready(function(){Page_script.init(),load_page()});