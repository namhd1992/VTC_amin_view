var editing_item=null,item_name="Tag",item_names="Tags",deleted_id=null,page_datatable=null,artical_id=null,Page_script=function(){return{init:function(){}}}(),load_page=function(){article_id=getUrlParameter("id"),$(".bs-select").selectpicker({iconBase:"fa",tickIcon:"fa-check"}),_send_info.data={newsId:article_id},page_datatable=$("#page_datatable").DataTable({ajax:{url:base_request_url+"/getCommentArticle",type:"POST",data:function(t){return JSON.stringify(_send_info.data)},contentType:"application/json",dataType:"json",dataSrc:function(t){return console.log(t.dataArr),console.log("custom"),t.dataArr},beforeSend:function(t){t.setRequestHeader("Authorization","bearer "+_user_data.access_token)},error:function(t,e,a){"invalid_token"==JSON.parse(t.responseText).error&&(localStorage.removeItem("user_data"),document.location.replace("login"))}},columns:[{title:"News",data:null,render:function(t,e,a,n){var s="/images/default_ava.jpg";null!==a.urlAvatar&&(s=a.urlAvatar);var d="Unknow";null!==a.firstName&&null!==a.lastName&&(d=a.firstName+" "+a.lastName);var i=new Date(a.createOn),o=_month_names[i.getMonth()]+" "+i.getDate()+", "+i.getFullYear()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds(),l="";return l+='<div class="mt-comments">',l+='<div class="mt-comment">',l+='<div class="mt-comment-img">',l+='<img src="'+s+'" /> </div>',l+='<div class="mt-comment-body">',l+='<div class="mt-comment-info">',l+='<span class="mt-comment-author">'+d+"</span>",l+='<span class="mt-comment-date">'+o+"</span>",l+="</div>",l+='<div class="mt-comment-text">'+a.content+"</div>",l+='<div class="mt-comment-details">',l+='<span class="mt-comment-status mt-comment-status-pending">'+a.numberLike+" Likes</span>",l+='<ul class="mt-comment-actions">',l+='<li><a class="btn_delete_item" item_id='+a.commentId+">Delete</a></li>",l+="</ul>",l+="</div>",l+="</div>",l+="</div>",l+="</div>",$(a.childrenComment).each(function(t,e){var a="/images/default_ava.jpg";null!==e.urlAvatar&&(a=e.urlAvatar);var n="Unknow";null!==e.firstName&&null!==e.lastName&&(n=e.firstName+" "+e.lastName);var s=new Date(e.createOn),d=_month_names[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear()+" "+s.getHours()+":"+s.getMinutes()+":"+s.getSeconds();l+='<div class="mt-comments mt-children">',l+='<div class="mt-comment">',l+='<div class="mt-comment-img">',l+='<img src="'+a+'" /> </div>',l+='<div class="mt-comment-body">',l+='<div class="mt-comment-info">',l+='<span class="mt-comment-author">'+n+"</span>",l+='<span class="mt-comment-date">'+d+"</span>",l+="</div>",l+='<div class="mt-comment-text">'+e.content+"</div>",l+='<div class="mt-comment-details">',l+='<span class="mt-comment-status mt-comment-status-pending">'+e.numberLike+" Likes</span>",l+='<ul class="mt-comment-actions">',l+='<li><a class="btn_delete_item" item_id='+e.commentId+">Delete</a></li>",l+="</ul>",l+="</div>",l+="</div>",l+="</div>",l+="</div>"}),l}}],aoColumnDefs:[{sWidth:"10%",aTargets:[0]}],autoWidth:!1,lengthChange:!1,info:!1,bSort:!1,bPaginate:!0,pagingType:"numbers",fnDrawCallback:function(t){$("#page_datatable thead").remove(),$("div.dataTables_wrapper div.dataTables_filter label").contents().filter(function(){return 1!=this.nodeType}).replaceWith(""),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("form-control"),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("input-inline"),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("input-medium"),$("div.dataTables_wrapper div.dataTables_filter label input").attr("placeholder","Search..."),$("div.dataTables_wrapper div.dataTables_filter label input").attr("id","inputSuccess"),$(".btn_edit_item").click(function(){var t=JSON.parse($(this).attr("item_obj"));editing_item=t.id,$("#modal_add_edit .modal-title").html("Edit "+item_name+" "+t.name),$("#modal_add_edit .txt_add_edit_item_name").val(t.name),$("#modal_add_edit .area_add_edit_item").val(t.description),$("#modal_add_edit .btn_modal_save_new").hide(),$("#modal_add_edit .btn_modal_save_update").show(),jQuery(".select_status option").filter(function(){return $.trim($(this).val())==t.status}).prop("selected",!0),$(".select_status").selectpicker("refresh"),"active"==t.status?$(".select_status button").css("background-color","#32c5d2"):$(".select_status button").css("background-color","red"),$("#modal_add_edit").modal("show")}),$(".btn_delete_item").click(function(){deleted_id=parseInt($(this).attr("item_id")),$("#modal_confirm").modal("show")})}}),$(".btn_add_new_item").click(function(){$("#modal_add_edit .modal-title").html("Create new "+item_name),$("#modal_add_edit .txt_add_edit_item_name").val(),$("#modal_add_edit .btn_modal_save_new").show(),$("#modal_add_edit .btn_modal_save_update").hide(),$("#modal_add_edit").modal("show")}),$("#page_datatable").on("order.dt",function(){console.log("Order")}).on("search.dt",function(){console.log("Search")}).on("page.dt",function(){console.log("paging")}).dataTable()};jQuery(document).ready(function(){Page_script.init(),load_page(),$(".btn_modal_save_new").click(function(){console.log($(".select_status option:selected").val()),_send_info.data={name:$(".txt_add_edit_item_name").val(),status:$(".select_status option:selected").val(),description:$(".area_add_edit_item").val()},$.ajax({url:base_request_url+"/tags",type:"POST",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(t){t.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(t){console.log(t),$("#modal_add_edit").modal("hide"),page_datatable.ajax.reload(null,!1),"F"==t.statusCode?show_toast_notif("success","Successfully","Created '"+$(".txt_add_edit_item_name").val()+"'",function(){}):show_toast_notif("success","Successfully","Created '"+$(".txt_add_edit_item_name").val()+"'",function(){})},error:function(t){show_toast_notif("error","Successfully","Error '"+t.responseText+"'",function(){})}})}),$(".btn_confirm_yes").click(function(){_send_info.data={commentId:deleted_id},$.ajax({url:base_request_url+"/commentArticle",type:"DELETE",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(t){t.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(){$("#modal_confirm").modal("hide"),_send_info.data={newsId:article_id},page_datatable.ajax.reload(),$("#modal_add_edit").modal("hide"),show_toast_notif("success","Successfully","Deleted: '"+$(".txt_add_edit_channel_name").val()+"'",function(){})},error:function(t){show_toast_notif("error","Error","'"+t.responseText+"'",function(){})}})}),$(".select_status").change(function(){"active"==$(this).val()?$(".select_status button").css("background-color","#32c5d2"):"inactive"==$(this).val()&&$(".select_status button").css("background-color","red")})});