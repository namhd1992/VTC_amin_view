function str_pad(e){return String("00"+e).slice(-2)}function html_str(e){var t="";return t+='<div class="form-group item_detail">',t+='<div class="col-xs-4">',t+='<select id="select_item_spin_'+e+'"  class="select_item_spin col-xs-4 form-control select2 select_default"><option value=0>Hãy Chọn Item</option>',$.each(spin_item_list,function(e,a){t+="<option value='"+a.id+"'>"+a.name+"</option>"}),t+="</select>",t+="</div>",t+='<div class="col-xs-7">',t+='<input type="hidden" class="spin_item_id spin_item_id_'+e+'" />',t+='<div class="col-xs-3"><input type="number" class="form-control position position_'+e+'" value="0"/></div>',t+='<div class="col-xs-3"><input type="number" disabled class="form-control ratio_'+e+'" value="0"/></div>',t+='<div class="col-xs-3"><input type="number" class="txt_add_edit_item_total_quantity txt_add_edit_item_total_quantity_'+e+' form-control" ></div>',t+='<div class="col-xs-3"><div class="stock stock_'+e+'"></div></div>',t+="</div>",t+='<div class="col-sx-1 del_item_button"><a class="btn btn-icon-only red btn_delete_item"><i class="fa fa-remove"></i></a></div>',t+="</div>",t}var search_value,load_autocomplete_component,editing_item=null,item_name="Spin",item_names="Spins",deleted_id=null,channel_arr=[],page_datatable=null,default_items=[];_current_page=1,_per_page=5;var typingTimer,item_list=[],doneTypingInterval=1e3,searching_value_timeout="",publisher_id=null,item_count=2,pair_count=1,spinType=null,spin_item_list=[],turnoverLandmarkList=[],turnoverLandmarkIdDeletes=[],Page_script={init:function(){}},des=new FroalaEditor("textarea#froala-editor"),load_page=function(){function e(e,t){var a="<div class='col-md-12 package_price_turn' style='margin-bottom:10px'>";return a+="<div class='col-xs-5'>",a+="<input type='number' class='txt_add_edit_item_price form-control' value='"+e+"' min='0'>",a+="</div>",a+="<div class='col-xs-1'><span style='font-size: 25px'>/</span></div>",a+="<div class='col-xs-5'>",a+="<input type='number' class='txt_add_edit_item_turn form-control' value='"+t+"'min='1'>",a+="</div>",a+="<div class='col-xs-1'>",a+="<button type='button' class='remove_package_price_turn btn red'>Xóa</button>",a+="</div>",a+="</div>",a}function t(e){$(".btn_delete_item").click(function(){$(this).parent().parent().remove()}),$(".select_item_spin").change(function(){var e=$(this);$.each(spin_item_list,function(t,a){a.id==e.val()&&e.parent().next().children().next().next().next().next().children().html(a.quantity)})})}$(".loading_icon").show(),_send_info.data={limit:_per_page,offset:0},page_datatable=$("#page_datatable").DataTable({ajax:{url:base_request_url+"/admin/luckySpin",type:"GET",data:function(e){return e.limit=_per_page,e.offset=_per_page*(_current_page-1),null!=search_value&&""!=search_value&&(e.searchValue=search_value),null!=publisher_id&&""!=publisher_id&&(e.publisherId=publisher_id),e},contentType:"application/json",dataType:"json",dataSrc:function(e){console.log(e);var t=0;if($(".datatable_paging").html(""),e.totalRecords>_per_page)for(t=1;t<=Math.ceil(e.totalRecords/_per_page);t++)t==_current_page?$(".datatable_paging").append("<span class='datatable_paging_number_active' page="+t+">"+t+"</span>"):1!=t&&t!=Math.ceil(e.totalRecords/_per_page)&&t!=_current_page-1&&t!=_current_page-2&&t!=_current_page+2&&t!=_current_page+1||(1==t&&_current_page>4?($(".datatable_paging").append("<span class='datatable_paging_number' page="+t+">"+t+"</span>"),$($(".datatable_paging_number")[0]).after("<span class='paging_truncate'>...</span>")):t==Math.ceil(e.totalRecords/_per_page)&&_current_page<Math.ceil(e.totalRecords/_per_page)-3?($(".datatable_paging").append("<span class='datatable_paging_number' page="+t+">"+t+"</span>"),$($(".datatable_paging_number")[$(".datatable_paging_number").length-1]).before("<span class='paging_truncate'>...</span>")):$(".datatable_paging").append("<span class='datatable_paging_number' page="+t+">"+t+"</span>"));else $(".datatable_paging").html("<span class='datatable_paging_number_active' page=1>1</span>");return $(".datatable_paging_number").click(function(e){_current_page=parseInt($(e.target).attr("page")),page_datatable.ajax.reload()}),e.data},beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},error:function(e,t,a){"invalid_token"==JSON.parse(e.responseText).error&&(localStorage.removeItem("user_data"),document.location.replace("login"))}},columns:[{title:"ID",data:"id"},{title:"Name",data:"name"},{title:"Spin times",data:"spinTimes"},{title:"Start date",data:null,render:function(e,t,a,i){var n=getSetting(_setting_data,"date_format"),s=moment.unix(a.startDate/1e3).format(n.value);return s}},{title:"End date",data:null,render:function(e,t,a,i){var n=getSetting(_setting_data,"date_format"),s=moment.unix(a.endDate/1e3).format(n.value);return s}},{title:"Action",data:null,render:function(e,t,a,i){return e="",e+="<a class='btn_edit_item' item_id='"+a.id+"' item_obj='"+JSON.stringify(a)+"'><i class='icon-wrench'></i> Edit </a>",e+="<a class='btn_delete_item' item_id='"+a.id+"' item_obj='"+JSON.stringify(a)+"'><i class='icon-trash'></i> Delete </a>",e}}],aoColumnDefs:[{sWidth:"5%",aTargets:[0]},{sWidth:"10%",aTargets:[1]},{sWidth:"5%",aTargets:[2]},{sWidth:"10%",aTargets:[3]},{sWidth:"15%",aTargets:[4]},{sWidth:"15%",aTargets:[5]}],autoWidth:!1,lengthChange:!1,info:!1,bSort:!1,bPaginate:!1,bFilter:!1,fnDrawCallback:function(e){$("div.dataTables_wrapper div.dataTables_filter label").contents().filter(function(){return 1!=this.nodeType}).replaceWith(""),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("form-control"),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("input-inline"),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("input-medium"),$("div.dataTables_wrapper div.dataTables_filter label input").attr("placeholder","Search..."),$("div.dataTables_wrapper div.dataTables_filter label input").attr("id","inputSuccess"),$(".btn_edit_item").click(function(){$("#add_giftcode_form").trigger("reset"),$("#modal_add_edit input:file").val("");var e=JSON.parse($(this).attr("item_obj"));editing_item=e.id,console.log(e),$("#modal_add_edit .modal-title").html("Edit "+item_name+" "+e.name),$(".txt_add_edit_item_name").val(e.name),$("#single_select_type_spin").val(e.type),$("#review_image_text").attr("src",e.image),$("#link_image_text").html(e.image),des.html.set(e.description),$(".txt_add_edit_item_link_live_stream").val(e.linkLiveStream),$(".txt_add_edit_item_free_per_day").val(e.freeSpinPerDay),$(".txt_add_edit_item_free_on_start").val(e.freeSpinOnStart),$(".txt_add_edit_item_total_quantity").val(0),$(".txt_add_edit_item_max_per_user").val(e.maxSpinPerUser),$("#single_select_buy_turn_type").val(e.buyTurnType),$(".package_price_turn").remove(),$(".txt_add_edit_item_price_per_turn").val(e.pricePerTurn);var a=getSetting(_setting_data,"date_format");$(".txt_add_edit_item_date_start").val(moment.unix(e.startDate/1e3).format(a.value)),$(".txt_add_edit_item_date_end").val(moment.unix(e.endDate/1e3).format(a.value)),$("#single_select_rank_type").val(e.rankingType),item_count=e.spinItems.length,$(".more_item").remove(),$(".quantity_left").parent().remove(),$(".item_detail").remove(),$(".add_item_button").remove(),$(e.spinItems).each(function(a,i){var n="";n+='<div class="col-sx-1 add_item_button">',n+='<a style="width:20%;margin-left:378px;font-size:17px;" class="btn btn-icon-only green btn_add_more_item">',n+='<i class="fa fa-plus"></i>',n+="</a>",n+="</div>",a==e.spinItems.length-1?$(".item_group").append(html_str(a)+n):$(".item_group").append(html_str(a)),$(".btn_add_more_item").click(function(){$(this).parent().before(html_str(a)),t()}),t(),$("#select_item_spin_"+a).val(i.item.id),$(".spin_item_id_"+a).val(i.id),$(".txt_add_edit_item_total_quantity_"+a).val(i.totalQuantity),$(".position_"+a).val(i.ratioIndex),$(".ratio_"+a).val(i.ratio),$(".stock_"+a).html(i.receivedQuantity)}),$(".position").change(function(){var e=0;$.each($(".position"),function(t,a){e+=Number($(this).val())}),$.each($(".position"),function(t,a){$(this).parent().next().children().val(Math.round($(this).val()/e*100*100)/100)})}),load_autocomplete_component(),$("#modal_add_edit .btn_modal_save_new").hide(),$("#modal_add_edit .btn_modal_save_update").show(),jQuery(".select_status option").filter(function(){return $.trim($(this).val())==e.status}).prop("selected",!0),$(".select_status").selectpicker("refresh"),"active"==e.status?$(".select_status button").css("background-color","#32c5d2"):$(".select_status button").css("background-color","red"),$(".btn_delete_item").show(),$(".btn_delete_item").attr("item_id",e.id),$("#modal_add_edit").modal("show"),$(".txt_add_edit_item_gold_time_start").val(moment.unix(e.goldTimeStart/1e3).format(a.value)),$(".txt_add_edit_item_gold_time_end").val(moment.unix(e.goldTimeEnd/1e3).format(a.value)),$(".txt_add_edit_item_gold_time_item_index").val(e.goldTimeItemIndex),$(".gold_time_status option").filter(function(){return $.trim($(this).val())==e.goldTimeStatus.toString()}).prop("selected",!0),$(".gold_time_status").selectpicker("refresh"),1==e.goldTimeStatus?$(".gold_time_status button").css("background-color","#32c5d2"):$(".gold_time_status button").css("background-color","red")}),$(".btn_delete_item").click(function(){deleted_id=parseInt($(this).attr("item_id")),$("#modal_confirm").modal("show")})}}),$("#add_package_price_turn").click(function(){var t=[];$.each($(".package_price_turn"),function(){0!=$(this).find(".txt_add_edit_item_price").val()&&0!=$(this).find(".txt_add_edit_item_turn").val()&&t.push($(this).find(".txt_add_edit_item_price").val()+":"+$(this).find(".txt_add_edit_item_turn").val())}),console.log(t.toString()),$(".button_package_price_turn").before(e(0,0)),$(".remove_package_price_turn").click(function(){$(this).parent().parent().remove()})}),load_autocomplete_component=function(){function e(e){if(e.loading)return e.text;var t="<div class='select2-result-repository clearfix'><div class='select2-result-repository__avatar'><img src='"+e.owner.avatar_url+"' /></div><div class='select2-result-repository__meta'><div class='select2-result-repository__title'>"+e.full_name+"</div>";return e.description&&(t+="<div class='select2-result-repository__description'>"+e.description+"</div>"),t+="<div class='select2-result-repository__statistics'><div class='select2-result-repository__forks'><span class='glyphicon glyphicon-flash'></span> "+e.forks_count+" Forks</div><div class='select2-result-repository__stargazers'><span class='glyphicon glyphicon-star'></span> "+e.stargazers_count+" Stars</div><div class='select2-result-repository__watchers'><span class='glyphicon glyphicon-eye-open'></span> "+e.watchers_count+" Watchers</div></div></div></div>",t}function t(e){return e.full_name||e.text}$.fn.select2.defaults.set("theme","bootstrap");var i="Type to search";$(".select2, .select2-multiple").select2({placeholder:i,width:null}),$(".select2-allow-clear").select2({allowClear:!0,placeholder:i,width:null}),$(".js-data-example-ajax").select2({width:"off",ajax:{url:"https://api.github.com/search/repositories",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,t){return{results:e.items}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1,templateResult:e,templateSelection:t}),$("button[data-select2-open]").click(function(){$("#"+$(this).data("select2-open")).select2("open")}),$(":checkbox").on("click",function(){$(this).parent().nextAll("select").prop("disabled",!this.checked)}),$(".select2, .select2-multiple, .select2-allow-clear, .js-data-example-ajax").on("select2:open",function(){if($(this).parents("[class*='has-']").length)for(var e=$(this).parents("[class*='has-']")[0].className.split(/\s+/),t=0;t<e.length;++t)e[t].match("has-")&&$("body > .select2-container").addClass(e[t]);"single_select_user"==$(this).attr("id")&&(typing_input=$(".select2-search__field")[0],$(typing_input).on("keypress",function(){console.log("press"),clearTimeout(typingTimer),typingTimer=setTimeout(function(){_send_info.data={limit:10,offset:0,roleName:"publisher",searchValue:$(typing_input).val()},searching_value_timeout=$(typing_input).val(),$("#single_select_user").html(""),$.ajax({url:base_request_url+"/admin/user",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){console.log("success");$(e.dataArr).each(function(e,t){var a="";a=null==t.username?t.fullName:t.username,$("#single_select_user").append("<option value='"+t.id+"'> "+a+"</option>")}),load_autocomplete_component(),$("#single_select_user").select2("open"),$($(".select2-search__field")[0]).val(searching_value_timeout)},error:function(e){console.log("error"),console.log(e.error())}})},doneTypingInterval)}))}),$(".js-btn-set-scaling-classes").on("click",function(){$("#select2-multiple-input-sm, #select2-single-input-sm").next(".select2-container--bootstrap").addClass("input-sm"),$("#select2-multiple-input-lg, #select2-single-input-lg").next(".select2-container--bootstrap").addClass("input-lg"),$(this).removeClass("btn-primary btn-outline").prop("disabled",!0)}),$("#single_select").change(function(){var e=parseInt($("#single_select").val());-1==$.inArray(e,channel_arr)&&(channel_arr.push(e),$(".current_channels").append("<span channel_id='"+e+"' class='tag label label-warning'><i class='fa fa-wrench'></i> "+$("#single_select option:selected").text()+"<span class='remove_channel' data-role='remove'></span></span>"),$(".txt_add_edit_item_channel").val(e),$(".current_channels .remove_channel").click(function(){$(".txt_add_edit_item_channel").val(""),a(parseInt($(this).parent().attr("channel_id"))),$(this).parent().remove()}))})},$(".bs-select").selectpicker({iconBase:"fa",tickIcon:"fa-check"});var a=function(e){channel_arr.splice(channel_arr.indexOf(e),1)}};jQuery(document).ready(function(){function e(e){var t=[],a=[];$.each(e,function(e,i){0!=i.id?t.push(i):a.push(i)}),$.ajax({url:base_request_url+"/admin/turnover-landmark/update",type:"POST",data:JSON.stringify(t),contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){"01"==e.status||show_toast_notif("error","Error",e.status.message)},error:function(e){show_toast_notif("error","Error","Error info: "+e.responseText)}}),$.ajax({url:base_request_url+"/admin/turnover-landmark/create",type:"POST",data:JSON.stringify(a),contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){"01"==e.status||show_toast_notif("error","Error","Unable to create TurnoverLandmark ")},error:function(e){show_toast_notif("error","Error","Error info: "+e.responseText)}})}function t(){null!=turnoverLandmarkIdDeletes&&$.ajax({url:base_request_url+"/admin/turnover-landmark/delete?ids="+turnoverLandmarkIdDeletes,type:"DELETE",contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){"01"==e.status||show_toast_notif("error","Error","Unable to delete TurnoverLandmark ")},error:function(e){show_toast_notif("error","Error","Error info: "+e.responseText)}})}function a(){if(flagNewImage){var e=new FormData;e.append("image",imageCarosel),$.ajax({url:base_request_url+"/admin/uploadImage",type:"POST",data:e,cache:!1,async:!1,contentType:!1,timeout:3e6,processData:!1,beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){"01"==e.status?(console.log(e),linkImage=e.data,""!==$("#link_image_text").html()&&i()):show_toast_notif("error","Fail","Upload Image Unsuccess")},error:function(e){show_toast_notif("error","Fail","Error '"+e.message+"'")}})}}function i(){flagNewImage&&(_send_info.data={urlImage:$("#link_image_text").html()},$.ajax({url:base_request_url+"/admin/deleteImage",type:"POST",data:JSON.stringify(_send_info.data),cache:!1,async:!1,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){page_datatable.ajax.reload(null,!1),"01"==e.status?(console.log(e),show_toast_notif("success","Successfully","Add new and Delete old image success")):show_toast_notif("error","Fail","Upload Image Unsuccess")},error:function(e){show_toast_notif("error","Fail","Error '"+e.message+"'")}}))}Page_script.init(),load_page(),$(".form_datetime").datetimepicker({autoclose:!0,todayBtn:!0,isRTL:App.isRTL(),format:"yyyy-MM-dd hh:ii",pickerPosition:App.isRTL()?"bottom-right":"bottom-left"}),$(".btn_add_new_item").click(function(){$("#add_giftcode_form").trigger("reset"),$("#modal_add_edit input:file").val(""),$("#review_image_text").hide(),$("#link_image_text").html(""),des=new FroalaEditor("textarea#froala-editor"),$(".item_detail").remove(),$(".add_item_button").remove(),$("#modal_add_edit .modal-title").html("Create new "+item_name),$(".hidden_add_edit_item_condidion").attr("name","conditionId"),$(".txt_add_edit_item_channel").attr("name","channelId"),$(".cb_add_edit_item_condition span").removeClass("checked"),$(".file_add_edit_item_giftcode").parent().parent().show(),$(".file_add_edit_item_giftcode").attr("name","giftCodeFile"),$(".more_item").remove(),$(".quantity_left").parent().remove(),$(".turnover-landmark").remove(),item_count=1,channel_arr=[],$("#modal_add_edit .btn_modal_save_new").show(),$("#modal_add_edit .btn_modal_save_update").hide(),$(".hidden_giftcode_id").remove(),$("#modal_add_edit").modal("show");var e="";e+='<div class="col-sx-1 add_item_button">',e+='<a style="width:20%;margin-left:378px;font-size:17px;" class="btn btn-icon-only green btn_add_more_item">',e+='<i class="fa fa-plus"></i>',e+="</a>",e+="</div>",$(".item_group").append(e),$(".btn_delete_item").click(function(){$(this).parent().parent().remove()}),$(".btn_add_more_item").click(function(){$(this).parent().before(html_str(0)),$(".btn_delete_item").click(function(){$(this).parent().parent().remove()}),$.each(spin_item_list,function(e,t){$(".select_item_spin").append("<option value='"+t.id+"'>"+t.name+"</option>")})})}),$(".btn_confirm_yes").click(function(){_send_info.data={},$.ajax({url:base_request_url+"/admin/luckySpin?spinEventId="+deleted_id,type:"DELETE",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(){$("#modal_confirm").modal("hide"),_send_info.data={},page_datatable.ajax.reload(),$("#modal_add_edit").modal("hide"),show_toast_notif("success","Successfully","Deleted: '"+deleted_id+"'")},error:function(e){show_toast_notif("error","Error","'"+e.responseText+"'")}})}),$(".btn_modal_save_new").click(function(){if(""!=$(".txt_add_edit_item_name").val())if(""!=$(".txt_add_edit_item_image").val())if(""!=$(".txt_add_edit_item_price").val())if(""!=$(".txt_add_edit_item_date_start").val())if(""!=$(".txt_add_edit_item_date_end").val())if(""!=des.html.get())if(""!=$(".txt_add_edit_item_free_per_day").val())if(""!=$(".txt_add_edit_item_free_on_start").val()){var e=new Date($(".txt_add_edit_item_date_start").val()).getTime(),t=new Date($(".txt_add_edit_item_date_end").val()).getTime();(new Date).getTime();if(e>t)show_toast_notif("error","Unable to create spin","Date range is invalid");else{var a=[];$.each($(".package_price_turn"),function(){0!=$(this).find(".txt_add_edit_item_price").val()&&0!=$(this).find(".txt_add_edit_item_turn").val()&&a.push($(this).find(".txt_add_edit_item_price").val()+":"+$(this).find(".txt_add_edit_item_turn").val())}),item_list=[];$(".item_group .item_detail").each(function(e,t){item_list.push({itemOfSpinId:$(t).find(".select_item_spin").val(),spinItemId:$(t).find(".spin_item_id").val(),quantity:$(t).find(".txt_add_edit_item_total_quantity").val(),position:$(t).find(".position").val()}),0}),_send_info.data={name:$(".txt_add_edit_item_name").val(),type:$("#single_select_type_spin").val(),image:$("#link_image_text").html(),description:des.html.get(),linkLiveStream:$(".txt_add_edit_item_link_live_stream").val(),freeSpinPerDay:$(".txt_add_edit_item_free_per_day").val(),freeSpinOnStart:$(".txt_add_edit_item_free_on_start").val(),maxSpinPerUser:$(".txt_add_edit_item_max_per_user").val(),startDate:1e3*new moment($(".txt_add_edit_item_date_start").val(),"YYYY-MMMM-D hh:mm").unix(),endDate:1e3*new moment($(".txt_add_edit_item_date_end").val(),"YYYY-MMMM-D hh:mm").unix(),buyTurnType:$("#single_select_buy_turn_type").val(),pricePerTurn:$(".txt_add_edit_item_price_per_turn").val(),status:$(".select_status option:selected").val(),goldTimeStart:1e3*new moment($(".txt_add_edit_item_gold_time_start").val(),"YYYY-MMMM-D hh:mm").unix(),goldTimeEnd:1e3*new moment($(".txt_add_edit_item_gold_time_end").val(),"YYYY-MMMM-D hh:mm").unix(),goldTimeItemIndex:$(".txt_add_edit_item_gold_time_item_index").val(),goldTimeStatus:$(".gold_time_status option").val(),itemOfSpin:item_list},$.ajax({url:base_request_url+"/admin/luckySpin",type:"POST",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){page_datatable.ajax.reload(null,!1),"01"==e.status?(show_toast_notif("success","Successfully","Created '"+$(".txt_add_edit_item_name").val()+"'"),$("#modal_add_edit").modal("hide")):show_toast_notif("error","Error","Unable to create "+item_name)},error:function(e){show_toast_notif("error","Error","Error info: "+e.responseText)}})}}else show_toast_notif("error","Unable to create spin","Free spin on start is required");else show_toast_notif("error","Unable to create spin","Free spin per day is required");else show_toast_notif("error","Unable to create spin","Spin description is required");else show_toast_notif("error","Unable to create spin","Spin end date is required");else show_toast_notif("error","Unable to create spin","Spin start date is required");else show_toast_notif("error","Unable to create spin","Spin price is required");else show_toast_notif("error","Unable to create spin","Spin image is required");else show_toast_notif("error","Unable to create spin","Spin name is required")}),$(".btn_modal_save_update").click(function(){if(""!=$(".txt_add_edit_item_name").val())if(""!=$(".txt_add_edit_item_image").val())if(""!=$(".txt_add_edit_item_price").val())if(""!=$(".txt_add_edit_item_date_start").val())if(""!=$(".txt_add_edit_item_date_end").val())if(""!=des.html.get())if(""!=$(".txt_add_edit_item_free_per_day").val())if(""!=$(".txt_add_edit_item_free_on_start").val()){var a=new Date($(".txt_add_edit_item_date_start").val()).getTime(),i=new Date($(".txt_add_edit_item_date_end").val()).getTime();(new Date).getTime();if(a>i)show_toast_notif("error","Unable to update spin","Date range is invalid");else{var n=[];$.each($(".package_price_turn"),function(){0!=$(this).find(".txt_add_edit_item_price").val()&&0!=$(this).find(".txt_add_edit_item_turn").val()&&n.push($(this).find(".txt_add_edit_item_price").val()+":"+$(this).find(".txt_add_edit_item_turn").val())}),item_list=[];$(".item_group .item_detail").each(function(e,t){item_list.push({itemOfSpinId:$(t).find(".select_item_spin").val(),spinItemId:$(t).find(".spin_item_id").val(),quantity:$(t).find(".txt_add_edit_item_total_quantity").val(),position:$(t).find(".position").val()}),0});var s=[];$(".turnover-landmark").each(function(e,t){s.push({id:$(t).find(".landmark-id").val(),game:$("#single_select_type_spin").val(),game_id:editing_item,item_id:$(t).find(".select_item_spin").val(),limit_quantity:$(t).find(".landmark-quantity").val(),limit_type:$(t).find(".landmark-type").val(),turnover_landmark:$(t).find(".landmark").val()})}),e(s),t(),_send_info.data={spinEventId:editing_item,name:$(".txt_add_edit_item_name").val(),type:$("#single_select_type_spin").val(),image:$("#link_image_text").html(),description:des.html.get(),linkLiveStream:$(".txt_add_edit_item_link_live_stream").val(),freeSpinPerDay:$(".txt_add_edit_item_free_per_day").val(),freeSpinOnStart:$(".txt_add_edit_item_free_on_start").val(),maxSpinPerUser:$(".txt_add_edit_item_max_per_user").val(),status:$(".select_status option:selected").val(),startDate:1e3*new moment($(".txt_add_edit_item_date_start").val(),"YYYY-MMMM-D hh:mm").unix(),endDate:1e3*new moment($(".txt_add_edit_item_date_end").val(),"YYYY-MMMM-D hh:mm").unix(),buyTurnType:$("#single_select_buy_turn_type").val(),pricePerTurn:$(".txt_add_edit_item_price_per_turn").val(),goldTimeStart:1e3*new moment($(".txt_add_edit_item_gold_time_start").val(),"YYYY-MMMM-D hh:mm").unix(),goldTimeEnd:1e3*new moment($(".txt_add_edit_item_gold_time_end").val(),"YYYY-MMMM-D hh:mm").unix(),goldTimeItemIndex:$(".txt_add_edit_item_gold_time_item_index").val(),goldTimeStatus:$(".gold_time_status option:selected").val(),itemOfSpin:item_list},$.ajax({url:base_request_url+"/admin/luckySpin",type:"PUT",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){"01"==e.status?(show_toast_notif("success","Successfully","Updated '"+$(".txt_add_edit_item_name").val()+"'"),$("#modal_add_edit").modal("hide"),page_datatable.ajax.reload(null,!1)):show_toast_notif("error","Error",e.onlyMessage)},error:function(e){show_toast_notif("error","Error","Error info: "+e.responseText)}})}}else show_toast_notif("error","Unable to update spin","Free spin on start is required");else show_toast_notif("error","Unable to update spin","Free spin per day is required");else show_toast_notif("error","Unable to update spin","Spin description is required");else show_toast_notif("error","Unable to update spin","Spin end date is required");else show_toast_notif("error","Unable to update spin","Spin start date is required");else show_toast_notif("error","Unable to update spin","Spin price is required");else show_toast_notif("error","Unable to update spin","Spin image is required");else show_toast_notif("error","Unable to update spin","Spin name is required")}),$(".select_status").change(function(){"active"==$(this).val()?$(".select_status button").css("background-color","#32c5d2"):"inactive"==$(this).val()&&$(".select_status button").css("background-color","red")}),$(".gold_time_status").change(function(){"true"==$(this).val()?$(".gold_time_status button").css("background-color","#32c5d2"):"false"==$(this).val()&&$(".gold_time_status button").css("background-color","red")}),$(".search_submit").click(function(){search_value=$(".search_input").val(),publisher_id=$("#single_select_user").val(),page_datatable.ajax.reload(null,!1)}),$(".search_clear").click(function(){$(".search_input").val(""),$("#single_select_user").val(""),load_autocomplete_component(),publisher_id="",search_value="",page_datatable.ajax.reload(null,!1)}),_send_info.data={limit:1e4,offset:0},$.ajax({url:base_request_url+"/admin/adminItemOfSpin",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){$(".loading_icon").hide(),$(e.dataArr).each(function(e,t){spin_item_list.push(t)}),load_autocomplete_component()},error:function(e){console.log(e.error())}}),$.ajax({url:base_request_url+"/admin/user",type:"GET",data:{limit:10,offset:0,roleName:"publisher"},contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){$(e.dataArr).each(function(e,t){var a="";a=null==t.username?t.fullName:t.username,$("#single_select_user").append("<option value='"+t.id+"'> "+a+"</option>")}),load_autocomplete_component(),$(".loading_icon").hide()},error:function(e){$(".loading_icon").hide(),console.log(e.error())}}),$("#txt_add_edit_image_text").change(function(){linkImage=null,flagNewImage=!1,imageCarosel=null;var e=this.files[0];(e="image/jpeg"==e.type||"image/png"==e.type||"image/jpg"==e.type||"image/gif"==e.type)?($("#review_image_text").show(),$("#review_image_text").attr("src",URL.createObjectURL(this.files[0])),imageCarosel=this.files[0],flagNewImage=!0):show_toast_notif("error","Error","Không Đúng Định Dạng Ảnh",function(){})}),$("#upload_image_text").click(function(){$(".loading_icon").show(),a(),$(".loading_icon").hide(),null!=linkImage?$("#link_image_text").html(linkImage):show_toast_notif("error","Error","Upload ảnh xảy ra lỗi",function(){})})});