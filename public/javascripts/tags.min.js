var editing_item=null,item_name="Tag",item_names="Tags",deleted_id=null,page_datatable=null;_current_page=1;var search_value=null,Page_script=function(){return{init:function(){}}}(),load_page=function(){_send_info.data={limit:_per_page,offset:_per_page*(_current_page-1)},$(".bs-select").selectpicker({iconBase:"fa",tickIcon:"fa-check"}),page_datatable=$("#page_datatable").DataTable({ajax:{url:base_request_url+"/admin/tags",type:"GET",data:function(a){a.limit=_per_page,a.offset=_per_page*(_current_page-1),null!=search_value&&(a.searchValue=search_value)},contentType:"application/json",dataType:"json",dataSrc:function(a){var e=0;if($(".datatable_paging").html(""),a.totalRecords>_per_page)for(e=1;e<=Math.ceil(a.totalRecords/_per_page);e++)e==_current_page?$(".datatable_paging").append("<span class='datatable_paging_number_active' page="+e+">"+e+"</span>"):1!=e&&e!=Math.ceil(a.totalRecords/_per_page)&&e!=_current_page-1&&e!=_current_page-2&&e!=_current_page+2&&e!=_current_page+1||(1==e&&_current_page>4?($(".datatable_paging").append("<span class='datatable_paging_number' page="+e+">"+e+"</span>"),$($(".datatable_paging_number")[0]).after("<span class='paging_truncate'>...</span>")):e==Math.ceil(a.totalRecords/_per_page)&&_current_page<Math.ceil(a.totalRecords/_per_page)-3?($(".datatable_paging").append("<span class='datatable_paging_number' page="+e+">"+e+"</span>"),$($(".datatable_paging_number")[$(".datatable_paging_number").length-1]).before("<span class='paging_truncate'>...</span>")):$(".datatable_paging").append("<span class='datatable_paging_number' page="+e+">"+e+"</span>"));else $(".datatable_paging").html("<span class='datatable_paging_number_active' page=1>1</span>");return $(".datatable_paging_number").click(function(a){_current_page=parseInt($(a.target).attr("page")),page_datatable.ajax.reload()}),a.dataArr},beforeSend:function(a){a.setRequestHeader("Authorization","bearer "+_user_data.access_token)},error:function(a,e,t){"invalid_token"==JSON.parse(a.responseText).error&&(localStorage.removeItem("user_data"),document.location.replace("login"))}},columns:[{title:"ID",data:"id"},{title:"Name",data:"name"},{title:"News",data:null,render:function(a,e,t,n){return"<i class='fa fa-rss-square'></i> "+t.numberNews}},{title:"Channels",data:null,render:function(a,e,t,n){return"<i class='fa fa-folder'></i> "+t.numberChannel}},{title:"Status",data:null,render:function(a,e,t,n){return a="active"==t.status?"<div class='active_status'>"+t.status+"</div>":"<div class='inactive_status'>"+t.status+"</div>"}},{title:"Action",data:null,render:function(a,e,t,n){var i="";return i="<a class='btn_edit_item' item_id='"+t.id+"' item_obj='"+JSON.stringify(t)+"'><i class='icon-wrench'></i> Edit </a>",i+="<a class='btn_delete_item' item_id='"+t.id+"' item_obj='"+JSON.stringify(t)+"'><i class='icon-trash'></i> Delete </a>"}}],aoColumnDefs:[{sWidth:"5%",aTargets:[0]},{sWidth:"25%",aTargets:[1]},{sWidth:"10%",aTargets:[2]},{sWidth:"10%",aTargets:[3]},{sWidth:"10%",aTargets:[4]},{sWidth:"15%",aTargets:[5]}],autoWidth:!1,lengthChange:!1,info:!1,bSort:!1,bPaginate:!1,fnDrawCallback:function(a){$("div.dataTables_wrapper div.dataTables_filter label").contents().filter(function(){return 1!=this.nodeType}).replaceWith(""),$(".btn_edit_item").click(function(){var a=JSON.parse($(this).attr("item_obj"));editing_item=a.id,$("#modal_add_edit .modal-title").html("Edit "+item_name+" "+a.name),$("#modal_add_edit .txt_add_edit_item_name").val(a.name),$("#modal_add_edit .area_add_edit_item").val(a.description),$("#modal_add_edit .btn_modal_save_new").hide(),$("#modal_add_edit .btn_modal_save_update").show(),jQuery(".select_status option").filter(function(){return $.trim($(this).val())==a.status}).prop("selected",!0),$(".select_status").selectpicker("refresh"),"active"==a.status?$(".select_status button").css("background-color","#32c5d2"):$(".select_status button").css("background-color","red"),$(".btn_delete_item").attr("item_id",$(this).attr("item_id")),$(".btn_delete_item").show(),$("#modal_add_edit").modal("show")}),$(".btn_delete_item").click(function(){deleted_id=parseInt($(this).attr("item_id")),$("#modal_confirm").modal("show")})},bFilter:!1}),$(".btn_add_new_item").click(function(){$("#modal_add_edit .modal-title").html("Create new "+item_name),$("#modal_add_edit .txt_add_edit_item_name").val(),$("#modal_add_edit .btn_modal_save_new").show(),$("#modal_add_edit .btn_modal_save_update").hide(),$(".btn_delete_item").hide(),$("#modal_add_edit").modal("show")}),$("#page_datatable").on("order.dt",function(){}).on("search.dt",function(){}).on("page.dt",function(){}).dataTable()};jQuery(document).ready(function(){Page_script.init(),load_page(),$(".search_submit").click(function(){search_value=$(".search_input").val(),page_datatable.ajax.reload(null,!1)}),$(".search_clear").click(function(){search_value="",$(".search_input").val(""),page_datatable.ajax.reload(null,!1)}),$(".btn_confirm_yes").click(function(){_send_info.data={tagId:deleted_id},$.ajax({url:base_request_url+"/admin/tags",type:"DELETE",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(a){a.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(){$("#modal_confirm").modal("hide"),_send_info.data={},page_datatable.ajax.reload(),$("#modal_add_edit").modal("hide"),show_toast_notif("success","Successfully","Deleted: '"+$("#modal_add_edit .txt_add_edit_item_name").val()+"'",function(){})},error:function(a){show_toast_notif("error","Error info: ",a.responseText,function(){})}})}),$(".btn_modal_save_new").click(function(){_send_info.data={name:$(".txt_add_edit_item_name").val(),status:$(".select_status option:selected").val(),description:$(".area_add_edit_item").val()},$.ajax({url:base_request_url+"/admin/tags",type:"POST",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(a){a.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(a){$("#modal_add_edit").modal("hide"),page_datatable.ajax.reload(null,!1),"F"==a.statusCode?show_toast_notif("success","Successfully","Created '"+$(".txt_add_edit_item_name").val()+"'",function(){}):show_toast_notif("Error","Error","Created '"+$(".txt_add_edit_item_name").val()+"'",function(){})},error:function(a){show_toast_notif("error","Error","Error info: "+a.responseText,function(){})}})}),$(".btn_modal_save_update").click(function(){_send_info.data={name:$(".txt_add_edit_item_name").val(),status:$(".select_status option:selected").val(),description:$(".area_add_edit_item").val(),id:editing_item},$.ajax({url:base_request_url+"/admin/tags",type:"PUT",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(a){a.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(){page_datatable.ajax.reload(null,!1),$("#modal_add_edit").modal("hide"),show_toast_notif("success","Successfully","Updated '"+$(".txt_add_edit_item_name").val()+"'",function(){})},error:function(a){show_toast_notif("error","Error","Error info: "+a.responseText,function(){})}})}),$(".select_status").change(function(){"active"==$(this).val()?$(".select_status button").css("background-color","#32c5d2"):"inactive"==$(this).val()&&$(".select_status button").css("background-color","red")})});