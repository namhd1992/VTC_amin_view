function str_pad(e){return String("00"+e).slice(-2)}function objectifyForm(e){for(var t={},a=0;a<e.length;a++)t[e[a].name]=e[a].value;return t}var editing_item=null,item_name="Notification",item_names="Notifications",deleted_id=null,channel_arr=[],channel_arr_normal=[],user_arr_normal=[],page_datatable=null;_current_page=1;var search_value=null,doneTypingInterval=500,typingTimer,searching_value_timeout="",Page_script=function(){return{init:function(){handleTimePickers()}}}(),load_page=function(){_send_info.data={limit:_per_page,offset:0},$(".bs-select").selectpicker({iconBase:"fa",tickIcon:"fa-check"});var e=function(e){channel_arr.splice(channel_arr.indexOf(e),1)},t=function(e){channel_arr_normal.splice(channel_arr_normal.indexOf(e),1)},a=function(e){user_arr_normal.splice(user_arr_normal.indexOf(e),1)};page_datatable=$("#page_datatable").DataTable({ajax:{url:base_request_url+"/admin/notification",type:"GET",data:function(e){e.limit=_per_page,e.offset=_per_page*(_current_page-1),null!=search_value&&(e.searchValue=search_value)},contentType:"application/json",dataType:"json",dataSrc:function(e){console.log(e);var t=0;if($(".datatable_paging").html(""),e.totalRecords>_per_page)for(t=1;t<=Math.ceil(e.totalRecords/_per_page);t++)t==_current_page?$(".datatable_paging").append("<span class='datatable_paging_number_active' page="+t+">"+t+"</span>"):1!=t&&t!=Math.ceil(e.totalRecords/_per_page)&&t!=_current_page-1&&t!=_current_page-2&&t!=_current_page+2&&t!=_current_page+1||(1==t&&_current_page>4?($(".datatable_paging").append("<span class='datatable_paging_number' page="+t+">"+t+"</span>"),$($(".datatable_paging_number")[0]).after("<span class='paging_truncate'>...</span>")):t==Math.ceil(e.totalRecords/_per_page)&&_current_page<Math.ceil(e.totalRecords/_per_page)-3?($(".datatable_paging").append("<span class='datatable_paging_number' page="+t+">"+t+"</span>"),$($(".datatable_paging_number")[$(".datatable_paging_number").length-1]).before("<span class='paging_truncate'>...</span>")):$(".datatable_paging").append("<span class='datatable_paging_number' page="+t+">"+t+"</span>"));else $(".datatable_paging").html("<span class='datatable_paging_number_active' page=1>1</span>");return $(".datatable_paging_number").click(function(e){_current_page=parseInt($(e.target).attr("page")),page_datatable.ajax.reload()}),e.dataArr},beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},error:function(e,t,a){"invalid_token"==JSON.parse(e.responseText).error&&(localStorage.removeItem("user_data"),document.location.replace("login"))}},columns:[{title:"ID",data:"id"},{title:"Title",data:"title"},{title:"To",data:null,render:function(e,t,a,n){var r=JSON.parse(a.sendTo),o="";return"all"==r.type||"android"==r.type||"ios"==r.type?o=r.type:"user"==r.type?o="user: "+r.name:"channel"==r.type&&(o="channel: "+r.name),o}},{title:"Type",data:"notifiType"},{title:"Action",data:null,render:function(e,t,a,n){return e="",e="<a class='btn_edit_item' item_id='"+a.id+"' item_obj='"+JSON.stringify(a)+"'><i class='icon-wrench'></i> Edit </a>",e+="<a class='btn_delete_item' item_id='"+a.id+"' item_obj='"+JSON.stringify(a)+"'><i class='icon-trash'></i> Delete </a>"}}],aoColumnDefs:[{sWidth:"5%",aTargets:[0]},{sWidth:"50%",aTargets:[1]},{sWidth:"15%",aTargets:[2]},{sWidth:"15%",aTargets:[3]},{sWidth:"15%",aTargets:[4]}],autoWidth:!1,lengthChange:!1,info:!1,bSort:!1,bPaginate:!1,bFilter:!1,fnDrawCallback:function(r){$("div.dataTables_wrapper div.dataTables_filter label").contents().filter(function(){return 1!=this.nodeType}).replaceWith(""),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("form-control"),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("input-inline"),$("div.dataTables_wrapper div.dataTables_filter label input").addClass("input-medium"),$("div.dataTables_wrapper div.dataTables_filter label input").attr("placeholder","Search..."),$("div.dataTables_wrapper div.dataTables_filter label input").attr("id","inputSuccess"),$(".btn_edit_item").click(function(){var r=JSON.parse($(this).attr("item_obj"));if(editing_item=r.id,$("#modal_add_edit .modal-title").html("Edit "+item_name+" "+r.title),$(".txt_add_edit_item_title").val(r.title),$(".txt_add_edit_item_message").val(r.message),"giftcode"==r.notifiType){$(".cb_condition").attr("checked","checked"),$(".cb_condition").parent().addClass("checked"),$(".form_group_giftcode").show(),$(".form_group_normal").hide(),$(".hidden_notifi_type").val("giftcode"),$(".hidden_notifi_giftcode_send_to").attr("name","sendTo"),$(".hidden_notifi_giftcode_send_type").attr("name","sendType"),$(".radio_send_to").attr("name",""),$(".radio_send_type").attr("name",""),$("#select2-single_select_giftcode_channel-container").html("");var o=JSON.parse(r.sendTo);channel_arr=[],channel_arr.push(o.value),$(".current_channels").html("<span channel_id='"+o.value+"' class='tag label label-primary'><i class='fa fa-folder'></i> "+o.name+"<span class='remove_channel' data-role='remove'></span></span>"),$(".txt_add_edit_item_giftcode_channel").val(o.value),$(".current_channels .remove_channel").click(function(){$(".txt_add_edit_item_giftcode_channel").val(""),e($(this).parent().attr("channel_id")),$(this).parent().remove()})}else $(".cb_condition").attr("checked",""),$(".cb_condition").parent().removeClass("checked"),$(".form_group_giftcode").hide(),$(".form_group_normal").show(),$(".hidden_notifi_type").val("normal"),$(".hidden_notifi_giftcode_send_to").attr("name",""),$(".hidden_notifi_giftcode_send_type").attr("name",""),$(".radio_send_to").attr("name","sendTo"),$(".radio_send_type").attr("name","sendType");if($(".radio_send_type").attr("checked",""),$(".radio_send_type").parent().removeClass("checked"),$(".radio_send_type[value="+r.sendType+"]").attr("checked","checked"),$(".radio_send_type[value="+r.sendType+"]").parent().addClass("checked"),"now"==r.sendType)$(".form_group_schedule").hide(),$(".form_group_repeat").hide();else if("schedule"==r.sendType){$(".form_group_schedule").show(),$(".form_group_repeat").hide();var i=new Date(r.sendOn),s="";s+=str_pad(i.getDate())+"/",s+=str_pad(i.getMonth()+1)+"/",s+=i.getFullYear(),$(".send_on_date").val(s);var l="";l+=str_pad(i.getHours())+":",l+=str_pad(i.getMinutes()),$(".send_on_time").val(l)}else if("repeat"==r.sendType){$(".form_group_schedule").hide(),$(".form_group_repeat").show(),$(".time_repeat").val(r.timeRepeat);var i=new Date(r.sendOn),s="";s+=str_pad(i.getDate())+"/",s+=str_pad(i.getMonth()+1)+"/",s+=i.getFullYear(),$(".send_on_date_repeat").val(s);var l="";l+=str_pad(i.getHours())+":",l+=str_pad(i.getMinutes()),$(".send_on_time_repeat").val(l)}var o=JSON.parse(r.sendTo);$(".radio_send_to").attr("checked",""),$(".radio_send_to").parent().removeClass("checked"),$(".radio_send_to[value="+o.type+"]").attr("checked","checked"),$(".radio_send_to[value="+o.type+"]").parent().addClass("checked"),"all"==o.type||"android"==o.type||"ios"==o.type?($(".form_group_to_user").hide(),$(".form_group_to_channel").hide()):"user"==o.type?($(".form_group_to_user").show(),$(".form_group_to_channel").hide(),$.inArray(o.value,user_arr_normal)==-1&&(user_arr_normal=[],user_arr_normal.push(o.value),$("#select2-single_select_normal_user-container").html(""),$(".current_normal_user").html(" <span user_id='"+o.value+"' class='tag label label-primary'><i class='fa fa-folder'></i> "+o.name+"<span class='remove_user' data-role='remove'></span></span>"),$(".txt_add_edit_item_normal_user").val(o.value),$(".current_normal_user .remove_user").click(function(){$(".txt_add_edit_item_normal_user").val(""),a($(this).parent().attr("user_id")),$(this).parent().remove()}))):"channel"==o.type&&($(".form_group_to_user").hide(),$(".form_group_to_channel").show(),$.inArray(o.value,channel_arr_normal)==-1&&(channel_arr_normal=[],channel_arr_normal.push(o.value),$("#select2-single_select_normal_channel-container").html(""),$(".current_normal_channels").html(" <span channel_id='"+o.value+"' class='tag label label-primary'><i class='fa fa-folder'></i> "+o.name+"<span class='remove_channel' data-role='remove'></span></span>"),$(".txt_add_edit_item_normal_channel").val(o.value),$(".current_normal_channels .remove_channel").click(function(){$(".txt_add_edit_item_normal_channel").val(""),t($(this).parent().attr("channel_id")),$(this).parent().remove()}),$("#single_select_normal_channel").val(parseInt(o.value)),console.log(o),n())),$("#modal_add_edit .btn_modal_save_new").hide(),$("#modal_add_edit .btn_modal_save_update").show(),jQuery(".select_status option").filter(function(){return $.trim($(this).val())==r.status}).prop("selected",!0),$(".btn_delete_item").show(),$(".btn_delete_item").attr("item_id",r.id),$("#modal_add_edit").modal("show")}),$(".btn_delete_item").click(function(){deleted_id=parseInt($(this).attr("item_id")),$("#modal_confirm").modal("show")})}}),$(".select2, .select2-multiple, .select2-allow-clear, .js-data-example-ajax").on("select2:open",function(){if($(this).parents("[class*='has-']").length)for(var e=$(this).parents("[class*='has-']")[0].className.split(/\s+/),t=0;t<e.length;++t)e[t].match("has-")&&$("body > .select2-container").addClass(e[t]);"single_select_normal_user"==$(this).attr("id")&&(typing_input=$(".select2-search__field")[0],$(typing_input).on("keypress",function(){console.log("press"),clearTimeout(typingTimer),typingTimer=setTimeout(function(){_send_info.data={limit:10,offset:0,searchValue:$(typing_input).val()},$("#single_select_normal_user").html(""),$.ajax({url:base_request_url+"/admin/user",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){console.log("success");$(e.dataArr).each(function(e,t){$("#single_select_normal_user").append("<option value='"+t.id+"'> "+t.username+"</option>")}),n(),$("#single_select_normal_user").select2("open"),$($(".select2-search__field")[0]).val(searching_value_timeout)},error:function(e){console.log("error"),console.log(e.error())}})},doneTypingInterval)}))});var n=function(){function n(e){if(e.loading)return e.text;var t="<div class='select2-result-repository clearfix'><div class='select2-result-repository__avatar'><img src='"+e.owner.avatar_url+"' /></div><div class='select2-result-repository__meta'><div class='select2-result-repository__title'>"+e.full_name+"</div>";return e.description&&(t+="<div class='select2-result-repository__description'>"+e.description+"</div>"),t+="<div class='select2-result-repository__statistics'><div class='select2-result-repository__forks'><span class='glyphicon glyphicon-flash'></span> "+e.forks_count+" Forks</div><div class='select2-result-repository__stargazers'><span class='glyphicon glyphicon-star'></span> "+e.stargazers_count+" Stars</div><div class='select2-result-repository__watchers'><span class='glyphicon glyphicon-eye-open'></span> "+e.watchers_count+" Watchers</div></div></div></div>"}function r(e){return e.full_name||e.text}$.fn.select2.defaults.set("theme","bootstrap");var o="Type to search";$(".select2").select2({placeholder:o,width:null}),$(".js-data-example-ajax").select2({width:"off",ajax:{url:"https://api.github.com/search/repositories",dataType:"json",delay:250,data:function(e){return{q:e.term,page:e.page}},processResults:function(e,t){return{results:e.items}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1,templateResult:n,templateSelection:r}),$("button[data-select2-open]").click(function(){$("#"+$(this).data("select2-open")).select2("open")}),$(":checkbox").on("click",function(){$(this).parent().nextAll("select").prop("disabled",!this.checked)}),$(".js-btn-set-scaling-classes").on("click",function(){$("#select2-multiple-input-sm, #select2-single-input-sm").next(".select2-container--bootstrap").addClass("input-sm"),$("#select2-multiple-input-lg, #select2-single-input-lg").next(".select2-container--bootstrap").addClass("input-lg"),$(this).removeClass("btn-primary btn-outline").prop("disabled",!0)}),$("#single_select_giftcode_channel").change(function(){$.inArray($("#single_select_giftcode_channel").val(),channel_arr)==-1&&(channel_arr=[],channel_arr.push($("#single_select_giftcode_channel").val()),$(".current_channels").html(" <span channel_id='"+$("#single_select_giftcode_channel").val()+"' class='tag label label-primary'><i class='fa fa-folder'></i> "+$("#single_select_giftcode_channel option:selected").text()+"<span class='remove_channel' data-role='remove'></span></span>"),$(".txt_add_edit_item_channel").val($("#single_select_giftcode_channel").val()),$(".current_channels .remove_channel").click(function(){$(".txt_add_edit_item_channel").val(""),e($(this).parent().attr("channel_id")),$(this).parent().remove()}))}),$("#single_select_normal_channel").change(function(){$.inArray($("#single_select_normal_channel").val(),channel_arr_normal)==-1&&(channel_arr_normal=[],channel_arr_normal.push($("#single_select_normal_channel").val()),$(".current_normal_channels").html(" <span channel_id='"+$("#single_select_normal_channel").val()+"' class='tag label label-primary'><i class='fa fa-folder'></i> "+$("#single_select_normal_channel option:selected").text()+"<span class='remove_channel' data-role='remove'></span></span>"),$(".txt_add_edit_item_normal_channel").val($("#single_select_normal_channel").val()),$(".current_normal_channels .remove_channel").click(function(){$(".txt_add_edit_item_normal_channel").val(""),t($(this).parent().attr("channel_id")),$(this).parent().remove()}))}),$("#single_select_normal_user").change(function(){$.inArray($("#single_select_normal_user").val(),user_arr_normal)==-1&&(user_arr_normal=[],user_arr_normal.push($("#single_select_normal_user").val()),$(".current_normal_user").html(" <span user_id='"+$("#single_select_normal_user").val()+"' class='tag label label-primary'><i class='fa fa-folder'></i> "+$("#single_select_normal_user option:selected").text()+"<span class='remove_user' data-role='remove'></span></span>"),$(".txt_add_edit_item_normal_user").val($("#single_select_normal_user").val()),$(".current_normal_user .remove_user").click(function(){$(".txt_add_edit_item_normal_user").val(""),a($(this).parent().attr("user_id")),$(this).parent().remove()}))}),$("#single_select_normal_user").focus(function(){this.selectedIndex=-1})};_send_info.data={limit:10,offset:0},$.ajax({url:base_request_url+"/admin/user",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){$(e.dataArr).each(function(e,t){$("#single_select_normal_user").append("<option value='"+t.id+"'> "+t.username+"</option>")}),n()},error:function(e){console.log("error"),console.log(e.error())}}),_send_info.data={},$.ajax({url:base_request_url+"/admin/channel",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){$(e.dataArr).each(function(e,t){$("#single_select_giftcode_channel").append("<option value='"+t.id+"'> "+t.name+"</option>"),$("#single_select_normal_channel").append("<option value='"+t.id+"'> "+t.name+"</option>")}),n()},error:function(e){console.log(e.error())}}),$(".btn_add_new_item").click(function(){$("#modal_add_edit .modal-title").html("Create new "+item_name),$("#modal_add_edit input:text").val(""),$("#modal_add_edit textarea").val(""),$(".txt_add_edit_item_channel").attr("name","channelId"),channel_arr=[],channel_arr_normal=[],user_arr_normal=[],$(".current_channels").html(""),$(".cb_condition").attr("checked",""),$(".cb_condition").parent().removeClass("checked"),$(".form_group_giftcode").hide(),$(".form_group_normal").show(),$(".hidden_notifi_type").val("normal"),$(".hidden_notifi_giftcode_send_to").attr("name",""),$(".hidden_notifi_giftcode_send_type").attr("name",""),$(".radio_send_to").attr("name","sendTo"),$(".radio_send_type").attr("name","sendType"),$(".radio_send_type").attr("checked",""),$(".radio_send_type").parent().removeClass("checked"),$(".radio_send_type[value=now]").attr("checked","checked"),$(".radio_send_type[value=now]").parent().addClass("checked"),$(".form_group_repeat").hide(),$(".form_group_schedule").hide(),$(".radio_send_to").attr("checked",""),$(".radio_send_to").parent().removeClass("checked"),$(".radio_send_to[value=all]").attr("checked","checked"),$(".radio_send_to[value=all]").parent().addClass("checked"),$(".form_group_to_channel").hide(),$("#modal_add_edit .btn_modal_save_new").show(),$("#modal_add_edit .btn_modal_save_update").hide(),$("#modal_add_edit").modal("show")}),$("#page_datatable").on("order.dt",function(){}).on("search.dt",function(e){}).dataTable(),$(".search_submit").click(function(){search_value=$(".search_input").val(),page_datatable.ajax.reload(null,!1)}),$(".search_clear").click(function(){search_value="",$(".search_input").val(""),page_datatable.ajax.reload(null,!1)}),$(".btn_confirm_yes").click(function(){_send_info.data={id:deleted_id},$.ajax({url:base_request_url+"/admin/notification",type:"DELETE",data:JSON.stringify(_send_info.data),contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(){$("#modal_confirm").modal("hide"),_current_page=1,page_datatable.ajax.reload(),$("#modal_add_edit").modal("hide"),show_toast_notif("success","Successfully","Deleted: '"+deleted_id+"'",function(){})},error:function(e){show_toast_notif("error","Error","'"+e.responseText+"'",function(){})}})}),$(".btn_modal_save_new").click(function(){var e=objectifyForm($($("#add_item_form")[0]).serializeArray());if(console.log(e.sendTo),"all"==e.sendTo?e.sendTo={type:"all",value:"all"}:"android"==e.sendTo?e.sendTo={type:"android",value:"android"}:"ios"==e.sendTo?e.sendTo={type:"ios",value:"ios"}:"user"==e.sendTo?(e.sendTo={type:"user",value:user_arr_normal[0]},console.log(e.sendTo)):"channel"==e.sendTo&&("normal"==e.notifiType?e.sendTo={type:"channel",value:channel_arr_normal[0]}:"giftcode"==e.notifiType&&(e.sendTo={type:"channel",value:channel_arr[0]})),"schedule"==e.sendType){if("normal"==e.notifiType){var t=$(".send_on_date").val(),a=t.split("/"),n=$(".send_on_time").val(),r=n.split(":"),o=new Date(a[2],parseInt(a[1],10)-1,a[0],r[0],r[1]);e.sendOn=o.getTime()}else if("giftcode"==e.notifiType){var i=new Date,n=$(".send_on_time_repeat_giftcode").val(),r=n.split(":"),o=new Date(i.getFullYear(),i.getMonth(),i.getDate(),r[0],r[1]);e.sendOn=o.getTime()}}else if("repeat"==e.sendType){var t=$(".send_on_date_repeat").val(),a=t.split("/"),n=$(".send_on_time_repeat").val(),r=n.split(":"),o=new Date(a[2],parseInt(a[1],10)-1,a[0],r[0],r[1]);e.sendOn=o.getTime(),e.timeRepeat=$(".time_repeat").val()}if(""==$(".txt_add_edit_item_title").val())return void show_toast_notif("error","Unable to create notification","Title is required",function(){});if(""==$(".txt_add_edit_item_message").val())return void show_toast_notif("error","Unable to create notification","Message is required",function(){});if("giftcode"==e.notifiType){if(channel_arr.length<1)return void show_toast_notif("error","Unable to create notification","You must choose channel",function(){});if(""==$(".send_on_time_repeat_giftcode").val())return void show_toast_notif("error","Unable to create notification","Time is required",function(){})}else{if("schedule"==e.sendType){if(""==$(".send_on_date").val())return void show_toast_notif("error","Unable to create notification","Date is required",function(){});if(""==$(".send_on_time").val())return void show_toast_notif("error","Unable to create notification","Time is required",function(){})}if("repeat"==e.sendType){if(""==$(".send_on_date_repeat").val())return void show_toast_notif("error","Unable to create notification","Date is required",function(){});if(""==$(".send_on_time_repeat").val())return void show_toast_notif("error","Unable to create notification","Time is required",function(){});if(""==$(".time_repeat").val())return void show_toast_notif("error","Unable to create notification","Repeat time is required",function(){})}if("channel"==e.sendTo.type&&channel_arr_normal.length<1)return void show_toast_notif("error","Unable to create notification","You must choose channel",function(){})}$.ajax({url:base_request_url+"/admin/notification",type:"POST",data:JSON.stringify(e),contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){page_datatable.ajax.reload(null,!1),"Success"==e.onlyMessage?($("#modal_add_edit").modal("hide"),show_toast_notif("success","Successfully","Created '"+$(".txt_add_edit_item_title").val()+"'",function(){})):show_toast_notif("error","Fail","Error while create "+item_name,function(){})},error:function(e){show_toast_notif("error","Successfully","Error '"+e.responseText+"'",function(){})}})}),$(".btn_modal_save_update").click(function(){var e=objectifyForm($($("#add_item_form")[0]).serializeArray());if(console.log(e),"all"==e.sendTo?e.sendTo={type:"all",value:"all"}:"android"==e.sendTo?e.sendTo={type:"android",value:"android"}:"ios"==e.sendTo?e.sendTo={type:"ios",value:"ios"}:"user"==e.sendTo?e.sendTo={type:"user",value:"ios"}:"channel"==e.sendTo&&("normal"==e.notifiType?e.sendTo={type:"channel",value:channel_arr_normal[0]}:"giftcode"==e.notifiType&&(e.sendTo={type:"channel",value:channel_arr[0]})),"schedule"==e.sendType){if("normal"==e.notifiType){var t=$(".send_on_date").val(),a=t.split("/"),n=$(".send_on_time").val(),r=n.split(":"),o=new Date(a[2],parseInt(a[1],10)-1,a[0],r[0],r[1]);e.sendOn=o.getTime()}else if("giftcode"==e.notifiType){var i=new Date,n=$(".send_on_time_repeat_giftcode").val(),r=n.split(":"),o=new Date(i.getFullYear(),i.getMonth(),i.getDate(),r[0],r[1]);e.sendOn=o.getTime()}}else if("repeat"==e.sendType){var t=$(".send_on_date_repeat").val(),a=t.split("/"),n=$(".send_on_time_repeat").val(),r=n.split(":"),o=new Date(a[2],parseInt(a[1],10)-1,a[0],r[0],r[1]);e.sendOn=o.getTime(),e.timeRepeat=$(".time_repeat").val()}if(e.id=editing_item,""==$(".txt_add_edit_item_title").val())return void show_toast_notif("error","Unable to update notification","Title is required",function(){});if(""==$(".txt_add_edit_item_message").val())return void show_toast_notif("error","Unable to update notification","Message is required",function(){});if("giftcode"==e.notifiType){if(channel_arr.length<1)return void show_toast_notif("error","Unable to update notification","You must choose channel",function(){});if(""==$(".send_on_time_repeat_giftcode").val())return void show_toast_notif("error","Unable to update notification","Time is required",function(){})}else{if("schedule"==e.sendType){if(""==$(".send_on_date").val())return void show_toast_notif("error","Unable to update notification","Date is required",function(){});if(""==$(".send_on_time").val())return void show_toast_notif("error","Unable to update notification","Time is required",function(){})}if("repeat"==e.sendType){if(""==$(".send_on_date_repeat").val())return void show_toast_notif("error","Unable to update notification","Date is required",function(){});if(""==$(".send_on_time_repeat").val())return void show_toast_notif("error","Unable to update notification","Time is required",function(){});if(""==$(".time_repeat").val())return void show_toast_notif("error","Unable to update notification","Repeat time is required",function(){})}if("channel"==e.sendTo.type&&channel_arr_normal.length<1)return void show_toast_notif("error","Unable to update notification","You must choose channel",function(){})}$.ajax({url:base_request_url+"/admin/notification",type:"PUT",data:JSON.stringify(e),contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){page_datatable.ajax.reload(null,!1),"Success"==e.onlyMessage?($("#modal_add_edit").modal("hide"),show_toast_notif("success","Successfully","Updated '"+$(".txt_add_edit_item_title").val()+"'",function(){})):show_toast_notif("error","Fail","Error",function(){})},error:function(e){show_toast_notif("error","Fail","Error '"+e.responseText+"'",function(){})}})}),$(".select_status").change(function(){"active"==$(this).val()?$(".select_status button").css("background-color","#32c5d2"):"inactive"==$(this).val()&&$(".select_status button").css("background-color","red")}),$(".cb_condition").change(function(){$(this).parent().hasClass("checked")?($(".form_group_giftcode").show(),$(".form_group_normal").hide(),$(".hidden_notifi_type").val("giftcode"),$(".hidden_notifi_giftcode_send_to").attr("name","sendTo"),$(".hidden_notifi_giftcode_send_type").attr("name","sendType"),$(".radio_send_to").attr("name",""),$(".radio_send_type").attr("name","")):($(".form_group_giftcode").hide(),$(".form_group_normal").show(),$(".hidden_notifi_type").val("normal"),$(".hidden_notifi_giftcode_send_to").attr("name",""),$(".hidden_notifi_giftcode_send_type").attr("name",""),$(".radio_send_to").attr("name","sendTo"),$(".radio_send_type").attr("name","sendType"))}),$(".radio_send_type").on("change",function(e){"now"==e.target.value?($(".form_group_schedule").hide(),$(".form_group_repeat").hide()):"schedule"==e.target.value?($(".form_group_schedule").show(),$(".form_group_repeat").hide()):"repeat"==e.target.value&&($(".form_group_schedule").hide(),$(".form_group_repeat").show())}),$(".radio_send_to").on("change",function(e){console.log(e.target.value),"all"==e.target.value||"android"==e.target.value||"ios"==e.target.value?($(".form_group_to_user").hide(),$(".form_group_to_channel").hide()):"user"==e.target.value?($(".form_group_to_user").show(),$(".form_group_to_channel").hide()):"channel"==e.target.value&&($(".form_group_to_user").hide(),$(".form_group_to_channel").show())}),$(".select2-search__field").on("click",function(){console.log($(this))})},handleTimePickers=function(){jQuery().timepicker&&($(".timepicker-default").timepicker({autoclose:!0,showSeconds:!0,minuteStep:1}),$(".timepicker-no-seconds").timepicker({autoclose:!0,minuteStep:5}),$(".timepicker-24").timepicker({autoclose:!0,minuteStep:5,showSeconds:!1,showMeridian:!1}),$(".timepicker").parent(".input-group").on("click",".input-group-btn",function(e){e.preventDefault(),$(this).parent(".input-group").find(".timepicker").timepicker("showWidget")})),$(".date-picker").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0})};jQuery(document).ready(function(){Page_script.init(),load_page()});