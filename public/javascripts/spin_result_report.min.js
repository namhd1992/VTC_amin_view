var luckySpins=[],luckySpin=null,valueMinDate=0,valueMaxDate=0,Result=(initChart=function(){function e(e,t,o){turnover_Chart=new Chart(a,{type:"line",data:{labels:e,datasets:[{label:"DOANH THU",data:t,backgroundColor:["rgba(105, 0, 132, 0)"],borderColor:["rgba(200, 99, 132, .7)"],borderWidth:2},{label:"DOANH THU TĂNG THÊM",data:o,backgroundColor:["rgba(105, 0, 132, 0)"],borderColor:["rgba(2, 99, 100, .2)"],borderWidth:2}]},options:{responsive:!0}})}function t(e,t){if(null!=e&&null!=e){var a=e.getContext("2d");total_index_Chart=new Chart(a,{type:"line",data:{labels:["1","2","3","4","5","6","7"],datasets:[{label:"",data:t,backgroundColor:["rgba(105, 0, 132, 0)"],borderColor:["rgba(200, 99, 132, 1)"],borderWidth:3}]},options:{responsive:!0}})}}$(".loading_icon").show(),_user_data=$.parseJSON(localStorage.getItem("user_data")),_send_info.data={limit:1,offset:0},$.ajax({url:base_request_url+"/admin/luckySpin",type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(e){$(".loading_icon").hide(),luckySpins=e.data;var t="";$.each(luckySpins,function(e,a){t+="<option value='"+a.id+"'>"+a.name+"</option>"}),$(".select_filter_lucky_spin").append(t)},error:function(e){$(".loading_icon").hide(),console.log("error"),console.log(e.error())}}),$(".select_filter_lucky_spin").change(function(){$.each(luckySpins,function(e,t){})});var a=$("#turnover_Chart")[0].getContext("2d");turnover_Chart=new Chart(a,{type:"line",data:{},options:{responsive:!0}}),$.each($(".chart_basic"),function(e,t){var a=t.getContext("2d");total_spin_turn_Chart=new Chart(a,{type:"line",data:{},options:{responsive:!0}})}),$(".datepicker").datetimepicker({autoclose:!0,todayBtn:!0,isRTL:App.isRTL(),format:"yyyy-MM-dd hh:ii",pickerPosition:App.isRTL()?"bottom-right":"bottom-left"}),$(".search_submit").click(function(){var a=$(".select_filter_lucky_spin").val();if($(".report_item").remove(),null!=a&&0!=a){$.each(luckySpins,function(e,t){$(".select_filter_lucky_spin").val()==t.id&&(luckySpin=t)}),getSetting(_setting_data,"date_format"),""==$(".txt_filter_date_start").val()&&$(".txt_filter_date_start").val(moment.unix(luckySpin.startDate/1e3).format("YYYY-MMMM-D HH:mm")),""==$(".txt_filter_date_end").val()&&$(".txt_filter_date_end").val(moment.unix(new Date/1e3).format("YYYY-MMMM-D HH:mm"));var o=1e3*new moment($(".txt_filter_date_start").val(),"YYYY-MMMM-D hh:mm").unix(),n=1e3*new moment($(".txt_filter_date_end").val(),"YYYY-MMMM-D hh:mm").unix();$(".loading_icon").show(),$.ajax({url:base_request_url+"/admin/spin-result-report?lucky_spin_id="+a+"&startDate="+o+"&endDate="+n,type:"GET",data:_send_info.data,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","bearer "+_user_data.access_token)},success:function(a){function r(e,t,a){var o="";o+='<div class="col-md-3 report_item">',o+='<div class="widget-thumb widget-bg-color-white text-uppercase margin-bottom-20 bordered">',o+='<h4 class="widget-thumb-heading">'+e+"</h4>",o+='<div class="widget-thumb-wrap">',o+='<i class="widget-thumb-icon bg-red icon-credit-card"></i>',o+='<div class="widget-thumb-body">',o+='<span class="widget-thumb-subtitle">Total</span>',o+='<span class="widget-thumb-body-stat '+t+'"  data-counter="counterup" data-value="'+a+'">0</span>',o+='<span class="widget-thumb-body-stat " style="color: yellowgreen"><canvas class="chart_basic" style="max-width: 500px; max-height: 100px;"></canvas></span>',o+="</div>",o+="</div>",o+="</div>",o+="</div>",$(".item-word").after($(o))}var s=[],_=[],i=[],c=[TURNOVER_BY_CARD=[],TURNOVER_BY_SCOIN=[],AWARDING_EXPENSES=[],BALANCE_EXPENSES=[],TOTAL_SPIN=[],TOTAL_SPIN_DONOT_ACCESS_SK=[],TOTAL_SPIN_ACCESS_SK=[],TOTAL_SPIN_USED=[],TOTAL_USER_JOIN_EVENT=[],SCOIN_5k=[],SCOIN_10k=[],SCOIN_20k=[],SCOIN_50k=[],SCOIN_100k=[],SCOIN_500k=[],SCOIN_1tr=[],SCOIN_5tr=[]],l=0;$.each(a.data,function(e,t){"ALL"!=t.date?(s.push(t.date),console.log("valueData.data",t.data),$.each(t.data,function(e,t){switch(t.typeItem){case"TURNOVER_SK":var a=Math.round(100*t.value)/100;Math.ceil(Math.floor((new Date(n).getTime()-new Date(o).getTime())/1e3)/86400),_.push(a),i.push(a-103e7);break;case"TURNOVER_BY_CARD":TURNOVER_BY_CARD.push(t.value);break;case"TURNOVER_BY_SCOIN":TURNOVER_BY_SCOIN.push(t.value);break;case"AWARDING_EXPENSES":AWARDING_EXPENSES.push(t.value),l=t.value,BALANCE_EXPENSES.push(13171783-t.value);break;case"TOTAL_SPIN":TOTAL_SPIN.push(t.total);break;case"TOTAL_SPIN_DONOT_ACCESS_SK":TOTAL_SPIN_DONOT_ACCESS_SK.push(t.total);break;case"TOTAL_SPIN_ACCESS_SK":TOTAL_SPIN_ACCESS_SK.push(t.total);break;case"TOTAL_SPIN_USED":TOTAL_SPIN_USED.push(t.total);break;case"LUCKY_NUMBER":LUCKY_NUMBER.push(t.total);break;case"TOTAL_USER_JOIN_EVENT":TOTAL_USER_JOIN_EVENT.push(t.total);break;case"SCOIN":switch(t.value){case 5e3:SCOIN_5k.push(t.total);break;case 1e4:SCOIN_10k.push(t.total);break;case 2e4:SCOIN_20k.push(t.total);break;case 5e4:SCOIN_50k.push(t.total);break;case 1e5:SCOIN_100k.push(t.total);break;case 5e5:SCOIN_500k.push(t.total);break;case 1e6:SCOIN_1tr.push(t.total);break;case 5e6:SCOIN_5tr.push(t.total)}}})):$.each(t.data,function(e,t){switch(t.typeItem){case"TURNOVER_SK":var a=Math.round(100*t.value)/100;countDayEvent=Math.ceil(Math.floor((new Date(n).getTime()-new Date(o).getTime())/1e3)/86400),$(".turnover_sk").text(a),$(".turnover_grow_up_sk").text(a-103e7*countDayEvent);break;case"TURNOVER_BY_CARD":$(".turnover_by_card").attr("data-value",t.value.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"));break;case"TURNOVER_BY_SCOIN":$(".turnover_by_scoin").attr("data-value",t.value.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"));break;case"AWARDING_EXPENSES":$(".awarding_expenses").attr("data-value",t.value.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"));var s=13171783*(countDayEvent-1)-(t.value-l);console.log("balance_expenses : ",s),console.log("value.value : ",t.value),console.log("awardingExpensesLastDay : ",l),$(".balance_expenses").attr("data-value",s.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"));break;case"TOTAL_SPIN":$(".total_spin_turn").attr("data-value",t.total);break;case"TOTAL_SPIN_DONOT_ACCESS_SK":$(".total_spin_not_access").attr("data-value",t.total);break;case"TOTAL_SPIN_ACCESS_SK":$(".total_spin_access").attr("data-value",t.total);break;case"TOTAL_SPIN_USED":$(".total_spin_turn_used").attr("data-value",t.total);break;case"LUCKY_NUMBER":$(".total_gift_lucky_spin").attr("data-value",t.total);break;case"TOTAL_USER_JOIN_EVENT":$(".total_user_join_event").attr("data-value",t.total);break;case"SCOIN":switch(t.value){case 5e3:r("SCOIN 5K","scoin_5k",t.total),$(".scoin_5k").counterUp();break;case 1e4:r("SCOIN 10K","scoin_10k",t.total),$(".scoin_10k").counterUp();break;case 2e4:r("SCOIN 20K","scoin_20k",t.total),$(".scoin_20k").counterUp();break;case 5e4:r("SCOIN 50K","scoin_50k",t.total),$(".scoin_50k").counterUp();break;case 1e5:r("SCOIN 100K","scoin_100k",t.total),$(".scoin_100k").counterUp();break;case 5e5:r("SCOIN 500K","scoin_500k",t.total),$(".scoin_500k").counterUp();break;case 1e6:r("SCOIN 1 triệu","scoin_1m",t.total),$(".scoin_1m").counterUp();break;case 5e6:r("SCOIN 5 Triệu","scoin_5m",t.total),$(".scoin_5m").counterUp()}}})}),e(s,_,i),$.each(c,function(e,a){0==a.length&&a.push(0),t($(".chart_basic")[e],a)}),$.each($(".money_text"),function(e,t){$(this).counterUp()}),$.each($(".money_text_SK"),function(e,t){$(this).text($(this).text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"))}),$(".loading_icon").hide()},error:function(e){$(".loading_icon").hide(),console.log("error"),console.log(e.error())}})}else show_toast_notif("error","Unable to search Item","You must be select lucky spin item")})},{init:function(){initChart()}});!1===App.isAngularJsApp()&&jQuery(document).ready(function(){Result.init()});